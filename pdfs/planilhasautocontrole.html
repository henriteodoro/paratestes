<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planilhas de Autocontrole - Pão de Ouro</title>
    <style>
        /* ===== base / tipografia ===== */
        :root {
            --azul: #007BFF;
            --azul-escuro: #0056b3;
            --amarelo: #FFD700;
            --vermelho: #b22222;
            --verde: #28a745;
            --laranja: #FF8C00;
            --roxo: #8A2BE2;
            --bg: #ffffff;
            --muted: #666;
        }
        
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: monospace;
            color: #111;
            background: #f7f9fb;
        }
        
        /* ===== header ===== */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--azul);
            color: white;
            padding: 10px 14px;
            gap: 12px;
            position: sticky;
            top: 0;
            z-index: 999;
        }
        
        .menu-left, .menu-right {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        .icon-btn {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 6px 8px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .icon-btn:hover {
            background: rgba(255,255,255,0.08);
        }
        
        .icon-btn img {
            width: 20px;
            height: 20px;
            filter: brightness(0) invert(1);
        }
        
        /* ===== título ===== */
        .titulo-nav {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 16px;
            margin: 14px 10px 8px;
        }
        
        .titulo-nav h1 {
            margin: 0;
            font-size: 18px;
            color: #111;
        }
        
        /* ===== container principal ===== */
        .container {
            display: flex;
            justify-content: center;
            gap: 20px;
            align-items: flex-start;
            padding: 10px 14px 24px;
            flex-wrap: wrap;
        }
        
        /* ===== controles ===== */
        .controls {
            width: 100%;
            max-width: 300px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(2,6,23,0.08);
            overflow: auto;
            border: 1px solid #e6eef8;
            padding: 15px;
        }
        
        .viewer {
            flex: 1;
            min-width: 500px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(2,6,23,0.08);
            overflow: hidden;
            border: 1px solid #e6eef8;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        .section {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.1rem;
            margin-bottom: 12px;
            padding-bottom: 6px;
            border-bottom: 1px solid #f1f5f9;
            color: #0b1225;
        }
        
        /* ===== botões de predefinição ===== */
        .preset-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .preset-btn {
            background: #f8fafc;
            border: 1px solid #e6eef8;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            font-family: monospace;
            color: #0b1225;
        }
        
        .preset-btn:hover {
            background: #f1f5f9;
        }
        
        .preset-btn.active {
            background: var(--azul);
            color: white;
            border-color: var(--azul);
        }
        
        /* ===== grid de páginas ===== */
        .pages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 8px;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #f1f5f9;
            border-radius: 6px;
        }
        
        .page-checkbox {
            display: none;
        }
        
        .page-label {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
            background: #f8fafc;
            border: 1px solid #e6eef8;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: bold;
            font-family: monospace;
        }
        
        .page-label:hover {
            background: #f1f5f9;
        }
        
        .page-checkbox:checked + .page-label {
            background: var(--azul);
            color: white;
            border-color: var(--azul);
        }
        
        /* ===== lista de páginas selecionadas ===== */
        .selected-pages {
            margin-top: 10px;
            padding: 10px;
            background: #f8fafc;
            border-radius: 6px;
            min-height: 50px;
            border: 1px solid #f1f5f9;
        }
        
        .selected-pages-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #0b1225;
        }
        
        .selected-pages-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .page-tag {
            background: var(--azul);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            font-family: monospace;
        }
        
        .page-tag .remove {
            margin-left: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        
        /* ===== botões de ação ===== */
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 10px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-align: center;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: var(--azul);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--azul-escuro);
        }
        
        .btn-secondary {
            background: var(--verde);
            color: white;
        }
        
        .btn-secondary:hover {
            background: #218838;
        }
        
        /* ===== visualizador de PDF ===== */
        .pdf-container {
            flex: 1;
            border: 1px solid #f1f5f9;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .pdf-viewer {
            width: 100%;
            height: 500px;
            border: none;
        }
        
        /* ===== responsividade ===== */
        @media (max-width: 900px) {
            .container {
                gap: 15px;
            }
            
            .controls, .viewer {
                max-width: 100%;
            }
        }
        
        @media (max-width: 520px) {
            .container {
                flex-direction: column;
                align-items: center;
            }
            
            .controls, .viewer {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="menu-left">
            <button class="icon-btn" id="btn-home" title="Menu inicial">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJtMyA5IDktNyA5IDd2MTFhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJ6Ij48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz0iOSAyMiA5IDEyIDE1IDEyIDE1IDIyIj48L3BvbHlsaW5lPjwvc3ZnPg==" alt="Início">
            </button>
        </div>
        <div class="menu-right">
            <button class="icon-btn" id="btn-print" title="Imprimir">
                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNNiA5VjJIMThWOSI+PC9wYXRoPjxwYXRoIGQ9Ik02IDE4SDRhMiAyIDAgMCAxLTItMnYtNWEyIDIgMCAwIDEgMi0yaDE2YTIgMiAwIDAgMSAyIDJ2NWEyIDIgMCAwIDEtMiAyaC0yIj48L3BhdGg+PHBhdGggZD0iTTYgMTRIMTguOE0xOCAxOFYyMiI+PC9wYXRoPjwvc3ZnPg==" alt="Imprimir">
            </button>
        </div>
    </header>
    
    <div class="titulo-nav">
        <h1>Planilhas de Autocontrole - Pão de Ouro</h1>
    </div>
    
    <div class="container">
        <div class="controls">
            <div class="section">
                <h2 class="section-title">Predefinições por Setor</h2>
                <div class="preset-buttons">
                    <button class="preset-btn" data-preset="limpeza">Limpeza</button>
                    <button class="preset-btn" data-preset="estoque">Estoque</button>
                    <button class="preset-btn" data-preset="manutencao">Manutenção</button>
                    <button class="preset-btn" data-preset="pre-pesagem">Pré-Pesagem</button>
                    <button class="preset-btn" data-preset="salgados">Salgados e Biscoitos</button>
                    <button class="preset-btn" data-preset="paes-doces">Pães Doces</button>
                    <button class="preset-btn" data-preset="embalagem">Embalagem</button>
                    <button class="preset-btn" data-preset="pao-de-sal">Pão de Sal</button>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">Seleção Manual de Páginas</h2>
                <p>Marque as páginas que deseja visualizar:</p>
                <div class="pages-grid" id="pages-grid">
                    <!-- As checkboxes serão geradas pelo JavaScript -->
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">Páginas Selecionadas</h2>
                <div class="selected-pages">
                    <div class="selected-pages-title">Nenhuma página selecionada</div>
                    <div class="selected-pages-list" id="selected-pages-list"></div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" id="view-btn">Visualizar PDF</button>
                <button class="btn btn-secondary" id="print-btn">Imprimir Selecionadas</button>
            </div>
        </div>
        
        <div class="viewer">
            <h2 class="section-title">Visualização do PDF</h2>
            <div class="pdf-container">
                <iframe class="pdf-viewer" id="pdf-viewer" src="" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <script>
        // Definição das predefinições por setor
        const presets = {
            limpeza: [40, 3, 4, 5, 6, 34, 42, 43],
            estoque: [28, 29, 30, 31, 33, 34],
            manutencao: [3, 4, 5, 6, 32, 34, 41, 2],
            'pre-pesagem': [35, 8, 9, 10, 11, 34],
            salgados: [38, 20, 21, 22, 23, 34],
            'paes-doces': [36, 12, 13, 14, 15, 34],
            embalagem: [39, 24, 25, 26, 27, 34],
            'pao-de-sal': [37, 16, 17, 18, 19, 34]
        };

        // Array para armazenar as páginas selecionadas
        let selectedPages = [];

        // Elementos DOM
        const pagesGrid = document.getElementById('pages-grid');
        const selectedPagesList = document.getElementById('selected-pages-list');
        const pdfViewer = document.getElementById('pdf-viewer');
        const viewBtn = document.getElementById('view-btn');
        const printBtn = document.getElementById('print-btn');
        const presetButtons = document.querySelectorAll('.preset-btn');

        // URL do PDF no GitHub Pages
        const pdfUrl = 'pdfs/Planilhas de Autocontrole - Pão de Ouro Atualizadas.pdf';

        // Gerar checkboxes para as páginas
        function generatePageCheckboxes() {
            for (let i = 1; i <= 43; i++) {
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `page-${i}`;
                checkbox.className = 'page-checkbox';
                checkbox.value = i;
                
                const label = document.createElement('label');
                label.htmlFor = `page-${i}`;
                label.className = 'page-label';
                label.textContent = i;
                
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        addPage(parseInt(this.value));
                    } else {
                        removePage(parseInt(this.value));
                    }
                });
                
                pagesGrid.appendChild(checkbox);
                pagesGrid.appendChild(label);
            }
        }

        // Adicionar página à seleção
        function addPage(pageNumber) {
            if (!selectedPages.includes(pageNumber)) {
                selectedPages.push(pageNumber);
                updateSelectedPagesList();
                updateCheckboxes();
            }
        }

        // Remover página da seleção
        function removePage(pageNumber) {
            const index = selectedPages.indexOf(pageNumber);
            if (index !== -1) {
                selectedPages.splice(index, 1);
                updateSelectedPagesList();
                updateCheckboxes();
            }
        }

        // Atualizar a lista de páginas selecionadas
        function updateSelectedPagesList() {
            selectedPagesList.innerHTML = '';
            
            if (selectedPages.length === 0) {
                selectedPagesList.innerHTML = '<div class="selected-pages-title">Nenhuma página selecionada</div>';
                return;
            }
            
            // Ordenar as páginas
            const sortedPages = [...selectedPages].sort((a, b) => a - b);
            
            sortedPages.forEach(page => {
                const pageTag = document.createElement('div');
                pageTag.className = 'page-tag';
                pageTag.innerHTML = `
                    Página ${page}
                    <span class="remove" data-page="${page}">×</span>
                `;
                
                pageTag.querySelector('.remove').addEventListener('click', function() {
                    removePage(page);
                });
                
                selectedPagesList.appendChild(pageTag);
            });
        }

        // Atualizar o estado das checkboxes
        function updateCheckboxes() {
            document.querySelectorAll('.page-checkbox').forEach(checkbox => {
                checkbox.checked = selectedPages.includes(parseInt(checkbox.value));
            });
        }

        // Aplicar uma predefinição
        function applyPreset(presetName) {
            if (presets[presetName]) {
                selectedPages = [...presets[presetName]];
                updateSelectedPagesList();
                updateCheckboxes();
                
                // Ativar o botão da predefinição
                presetButtons.forEach(btn => {
                    if (btn.dataset.preset === presetName) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            }
        }

        // Visualizar o PDF com as páginas selecionadas
        function viewPDF() {
            if (selectedPages.length === 0) {
                alert('Selecione pelo menos uma página para visualizar.');
                return;
            }
            
            // Ordenar as páginas
            const sortedPages = [...selectedPages].sort((a, b) => a - b);
            
            // Montar a URL com as páginas selecionadas
            // Nota: Esta abordagem pode não funcionar em todos os navegadores
            // Uma alternativa seria usar PDF.js para uma experiência mais controlada
            const pageParam = sortedPages.join(',');
            pdfViewer.src = `${pdfUrl}#page=${sortedPages[0]}`;
        }

        // Imprimir as páginas selecionadas
        function printSelectedPages() {
            if (selectedPages.length === 0) {
                alert('Selecione pelo menos uma página para imprimir.');
                return;
            }
            
            // Abrir o PDF em uma nova janela para impressão
            const sortedPages = [...selectedPages].sort((a, b) => a - b);
            const printWindow = window.open(`${pdfUrl}#page=${sortedPages[0]}`, '_blank');
            
            // Tentar imprimir após o carregamento
            printWindow.onload = function() {
                printWindow.print();
            };
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            generatePageCheckboxes();
            
            // Configurar eventos dos botões de predefinição
            presetButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    applyPreset(this.dataset.preset);
                });
            });
            
            // Configurar eventos dos botões de ação
            viewBtn.addEventListener('click', viewPDF);
            printBtn.addEventListener('click', printSelectedPages);
            
            // Selecionar uma predefinição por padrão
            applyPreset('limpeza');
            
            // Configurar botões do header
            document.getElementById('btn-home').addEventListener('click', function() {
                window.location.href = 'index.html';
            });
            
            document.getElementById('btn-print').addEventListener('click', function() {
                printSelectedPages();
            });
        });
    </script>
</body>
</html>
