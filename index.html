<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</title>

  <!-- bibliotecas para salvar em PDF / Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    :root{
      --azul:#007BFF;
      --amarelo:#FFD700;
      --vermelho:#d9534f;
      --bg:#f5f7fb;
      --mono: monospace;
    }

    body{
      font-family: Arial, sans-serif;
      margin:0;
      background:var(--bg);
      color:#111;
    }

    /* HEADER */
    header{
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:var(--azul);
      color:#fff;
      padding:12px 18px;
      position:relative;
    }
    header h1{
      margin:0;
      font-size:18px;
      text-align:center;
      width:100%;
    }
    .left-controls, .right-controls{
      display:flex;
      gap:8px;
      align-items:center;
      z-index:3;
    }
    .icon-btn{
      background:none;
      border:none;
      color:#fff;
      cursor:pointer;
      font-size:18px;
      padding:6px 8px;
      position:relative;
    }
    /* tooltip simples (texto sobre o √≠cone) */
    .icon-btn[data-tooltip]:hover::after{
      content: attr(data-tooltip);
      position:absolute;
      bottom:-28px;
      left:50%;
      transform:translateX(-50%);
      background: rgba(0,0,0,0.75);
      color:#fff;
      padding:4px 8px;
      border-radius:4px;
      font-size:12px;
      white-space:nowrap;
    }

    /* dropdown menu (esquerda) */
    .menu-dropdown{
      position:relative;
    }
    .menu-popup{
      position:absolute;
      top:44px;
      left:0;
      min-width:160px;
      background:#fff;
      color:#111;
      border-radius:8px;
      box-shadow:0 6px 18px rgba(0,0,0,0.15);
      display:none;
      overflow:hidden;
      animation:fadeIn .25s ease;
      font-size:14px;
    }
    .menu-popup a{
      display:block;
      padding:8px 10px;
      text-decoration:none;
      color:#111;
      border-bottom:1px solid #eee;
    }
    .menu-popup a:last-child{ border-bottom:none; }
    .menu-popup a:hover{ background:#f2f6ff; }

    /* save options dropdown (direita) */
    .save-popup{
      position:absolute;
      top:44px;
      right:10px;
      min-width:160px;
      background:#fff;
      color:#111;
      border-radius:8px;
      box-shadow:0 6px 18px rgba(0,0,0,0.15);
      display:none;
      overflow:hidden;
      animation:fadeIn .25s ease;
      font-size:14px;
    }
    .save-popup div{ padding:8px 10px; cursor:pointer; border-bottom:1px solid #eee; }
    .save-popup div:hover{ background:#f2f6ff; }
    .save-popup div:last-child{ border-bottom:none; }

    @keyframes fadeIn{
      from{ opacity:0; transform:translateY(-6px) }
      to{ opacity:1; transform:none }
    }

    /* layout principal */
    .wrapper{
      max-width:1100px;
      margin:18px auto;
      padding:0 12px 40px;
    }
    .container{
      display:flex;
      gap:40px;
      justify-content:center;
      align-items:flex-start;
    }
    .column{
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width:320px;
      width:380px;
      background:#fff;
      padding:12px;
      border-radius:8px;
      box-shadow:0 4px 12px rgba(0,0,0,0.06);
    }

    .col-title{
      font-weight:bold;
      text-align:center;
      margin-bottom:6px;
    }

    .item{
      display:flex;
      align-items:center;
      gap:8px;
      padding:6px 4px;
    }
    .item span{
      flex:1;
      font-family:var(--mono);
      font-size:13px;
    }
    .item input[type="text"]{
      width:70px;
      padding:6px 8px;
      font-family:var(--mono);
      font-size:13px;
      border:1px solid #ddd;
      border-radius:4px;
    }
    .item input[readonly]{
      background:#fafafa;
      color:#222;
    }

    /* middle controls */
    #middle-controls{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:8px;
      margin-top:40px;
    }
    .btn-arrow{
      background:var(--azul);
      color:#fff;
      border:none;
      padding:10px 14px;
      font-size:18px;
      border-radius:6px;
      cursor:pointer;
    }
    .btn-yellow{ background:var(--amarelo); color:#000; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; }
    .btn-reset{ background:var(--vermelho); color:#fff; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; }

    /* contador */
    #contador-linhas{ text-align:center; font-weight:bold; margin-bottom:8px; }

    /* mensagem discreta copiar */
    #copy-msg{
      position:absolute;
      right:10px;
      top:44px;
      color: #dff0d8;
      background: rgba(0,0,0,0.0);
      font-size:13px;
      pointer-events:none;
    }

    /* footer MACs - grid */
    footer.mac-grid{
      max-width:1100px;
      margin:20px auto;
      padding:18px;
    }
    .mac-grid{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:10px;
      font-family:var(--mono);
    }
    .mac-grid div{
      background:#fff;padding:10px;border-radius:6px;text-align:center;box-shadow:0 2px 8px rgba(0,0,0,0.06);
    }

    /* print rules: show only list direita */
    @media print{
      body *{ visibility:hidden }
      #print-area, #print-area *{ visibility:visible }
      #print-area{ position: absolute; left:0; top:0; width:100%; padding:20px; }
    }

    /* small screens */
    @media(max-width:980px){
      .container{ flex-direction:column; align-items:center }
      .mac-grid{ grid-template-columns:repeat(2,1fr) }
    }
  </style>
</head>
<body>

  <header>
    <div class="left-controls">
      <div class="menu-dropdown">
        <button class="icon-btn" data-tooltip="Menu" onclick="toggleMenu()">‚ò∞</button>
        <div class="menu-popup" id="menuPopup">
          <a href="#" onclick="alert('Em breve')">P√°gina 1 (em breve)</a>
          <a href="#" onclick="alert('Em breve')">P√°gina 2 (em breve)</a>
          <a href="#" onclick="alert('Em breve')">P√°gina 3 (em breve)</a>
        </div>
      </div>

      <button class="icon-btn" data-tooltip="Fechar" onclick="alert('Fechar (em breve)')">‚úñ</button>
      <button class="icon-btn" data-tooltip="Menu inicial" onclick="alert('Menu inicial (em breve)')">üè†</button>
    </div>

    <h1>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</h1>

    <div class="right-controls" style="position:relative;">
      <button class="icon-btn" data-tooltip="Salvar" onclick="toggleSave()">üíæ</button>
      <button class="icon-btn" data-tooltip="Imprimir" onclick="printOnlyRight()">üñ®Ô∏è</button>
      <button class="icon-btn" data-tooltip="Copiar" onclick="copyRight()" id="copyBtn">üìã</button>

      <div id="savePopup" class="save-popup">
        <div onclick="saveAs('txt')">Salvar como TXT</div>
        <div onclick="saveAs('pdf')">Salvar como PDF</div>
        <div onclick="saveAs('excel')">Salvar como Excel</div>
      </div>

      <div id="copy-msg" aria-live="polite"></div>
    </div>
  </header>

  <div class="wrapper">
    <div class="container">
      <!-- coluna esquerda -->
      <div class="column" id="coluna-esquerda">
        <div class="col-title">Coluna Esquerda (digite n√∫meros)</div>
        <!-- itens gerados via JS -->
      </div>

      <!-- middle -->
      <div id="middle-controls">
        <button class="btn-arrow" id="btn-transfer" title="Transferir" onclick="transferir()">‚Üí</button>
        <button class="btn-yellow" id="btn-toggle" onclick="toggleRemoveEmpty()">Remover Linhas Vazias</button>
        <button class="btn-reset" onclick="resetAll()">Resetar Tudo</button>
      </div>

      <!-- coluna direita -->
      <div class="column" id="coluna-direita-wrapper">
        <div id="contador-linhas">Linhas Preenchidas: 0</div>
        <div class="column" id="coluna-direita">
          <div style="font-size:12px;color:#666;text-align:center;margin-bottom:6px;">Coluna Direita (sa√≠da)</div>
          <!-- itens gerados via JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- elementos para impress√£o -->
  <div id="print-area" style="display:none"></div>

  <!-- footer com outros macs -->
  <footer class="mac-grid">
    <div class="mac-grid">
      <div>MAC 78 - Bairro Planalto<br><small style="color:#999">(em breve)</small></div>
      <div>MAC 79 - Romeu Duarte<br><small style="color:#999">(em breve)</small></div>
      <div>MAC 80 - Rua S√£o Geraldo / Centro 2<br><small style="color:#999">(em breve)</small></div>
      <div>MAC 277 - Matriz<br><small style="color:#999">(em breve)</small></div>
      <div>MAC 853 - Concesso<br><small style="color:#999">(em breve)</small></div>
      <div>MAC 1249 - Jardim do Lago<br><small style="color:#999">(em breve)</small></div>
      <div>MAC Ara√∫jos<br><small style="color:#999">(em breve)</small></div>
    </div>
  </footer>

<script>
/* ---------------------------
   Dados (preenchidos com suas frases)
   --------------------------- */
const frasesEsquerda = [
  "P√ÉO DE QUEIJO RECHEADO FRANGO  PAC7KG",
  "P√ÉO DE QUEIJO  7KG",
  "P√ÉO FRANC√äS 6HRS PAC 7KG",
  "P√ÉO DE 4 HRS  7KG",
  "BAGUETE 6  HRS  7KG",
  "BISCOITO DOCE FRITO MP 1 KG",
  "BISCOITO DE QUEIJO MP 7 KG",
  "BISCOITO SEQUILHO MP MANGA",
  "BISCOITO TR√äS QUEIJOS MP 7 KG",
  "BOLO FUBA CREMOSO MP 1 UNIDADE",
  "BOLO MILHO MP 1 UNIDADE",
  "BROINHA DE FUBA DOCE MP 7 KG",
  "BROINHA BACON TEMPERADA MP 7 KG",
  "CROISSANT DE FRANGO MP 7 KG",
  "CROISSANT DE PRESUNTO MP 7KG",
  "P√ÉO DE QUEIJO MEIA LUA MP PAC COM 10 UNI",
  "P√ÉO DOCE C/CREME MP 7KG",
  "P√ÉO DOCE MP 7KG",
  "P√ÉO PANHOCA MP 7KG",
  "ROSCOVADO MP UNIDADE",
  "ROSCA CREME E COCO MP PAC COM 5 UNI",
  "ROSCA TRANCA MP PAC COM 10 UNID",
  "ROSCA TRANCINHA MP PAC 3KG",
  "ROSCA TRANCA REDONDA MP",
  "ROSQUINHA CANUDINHO DE QUEIJO MP PAC COM 7KG",
  "SALGADO COXINHA DE FRANGO MP 1 KG",
  "SALGADOS BOLINHA DE CARNE MP 1KG",
  "SALGADOS EMPADA DE FRANGO MP 1 KG",
  "SALGADOS ENROLADINHO PRESUNTO MP 1 KG",
  "SALGADOS PASTEL CATUPIRY MP 1 KG",
  "SALGADOS KIBE CATUPIRY MP 1 KG",
  "SONHO MP PAC 3 KG"
];

const frasesDireita = [
  "Baguete 06hrs 7kg",
  "Biscoitinho doce frito 1kg",
  "Biscoito de queijo 7kg",
  "Biscoito tr√™s queijos 7kg",
  "Bolinha de carne pequena 1kg",
  "Bolo cremoso de fub√° 1 unidade",
  "Bolo cremoso de milho 1 unidade",
  "Broinha de fub√° doce 7kg",
  "Broinha temperada com bacon 7kg",
  "Canudinho de queijo 7kg",
  "Caracol 7kg",
  "Carioca 7kg",
  "Coxinha de frango pequena 1kg",
  "Croissant de frango 7kg",
  "Croissant de presunto 7kg",
  "Empadinha de frango pequena 1kg",
  "Enroladinho de presunto pequeno 1kg",
  "Meia lua 1kg com 10 unidades",
  "Mistura biscoito sequilho 4kg",
  "Panhoca 7kg",
  "P√£o de queijo recheado frango 7kg",
  "P√£o de queijo tradicional 7kg",
  "P√£o franc√™s 04hrs 7kg",
  "P√£o franc√™s 06hrs 7kg",
  "Pastelzinho catupiry pequeno 1kg",
  "Quibe com catupiry pequeno 1kg",
  "Rosca creme e coco PCT 5 unidades",
  "Roscovado 1 unidade",
  "Sonho PCT 3kg",
  "Tran√ßa PCT 10 unidades",
  "Trancinha PCT 3kg",
  "Trancinha redonda"
];

// mapa: para cada √≠ndice i (0..31) da esquerda, destino √© mapaConexao[i] - 1
const mapaConexao = [5,6,7,9,27,10,11,12,13,25,17,18,26,14,15,28,29,16,8,19,1,2,4,3,30,31,21,20,32,22,23,24];

/* ---------------------------
   Estado e helpers
   --------------------------- */
let hiddenIndices = []; // √≠ndices na direita que est√£o ocultos
let removedToggle = false; // estado do bot√£o √∫nico
const colEsqEl = document.getElementById('coluna-esquerda');
const colDirEl = document.getElementById('coluna-direita');

/* monta interface: cria os itens nas colunas */
function montarInterface(){
  colEsqEl.innerHTML = '<div style="font-size:12px;color:#666;text-align:center;margin-bottom:6px;">Coluna Esquerda (preencha)</div>';
  colDirEl.innerHTML = ''; // titulo j√° acima

  for(let i=0;i<frasesEsquerda.length;i++){
    // esquerda: label + input (onde voce escreve n√∫mero ou qtde)
    const divL = document.createElement('div');
    divL.className = 'item';
    const spanL = document.createElement('span');
    spanL.textContent = frasesEsquerda[i];
    const inputL = document.createElement('input');
    inputL.type = 'text';
    inputL.dataset.index = i;
    inputL.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter'){ // ao pressionar Enter, chamar transferir para praticidade
        transferir();
      }
    });
    divL.appendChild(spanL);
    divL.appendChild(inputL);
    colEsqEl.appendChild(divL);

    // direita: label + output (readOnly)
    const divR = document.createElement('div');
    divR.className = 'item';
    const spanR = document.createElement('span');
    spanR.textContent = frasesDireita[i];
    const outputR = document.createElement('input');
    outputR.type = 'text';
    outputR.readOnly = true;
    outputR.dataset.index = i;
    divR.appendChild(spanR);
    divR.appendChild(outputR);
    colDirEl.appendChild(divR);
  }

  atualizarContador();
}

/* atualiza contador de linhas preenchidas na direita */
function atualizarContador(){
  const outputs = colDirEl.querySelectorAll('input[type="text"]');
  const count = Array.from(outputs).filter(o => o.value && o.value.trim() !== '').length;
  document.getElementById('contador-linhas').textContent = `Linhas Preenchidas: ${count}`;
}

/* Transferir valores: percorre left inputs e coloca nos outputs de acordo com mapaConexao */
function transferir(){
  const inputs = colEsqEl.querySelectorAll('input[type="text"]');
  const outputs = colDirEl.querySelectorAll('input[type="text"]');

  for(let i=0;i<mapaConexao.length && i<inputs.length;i++){
    const origemIndex = i;
    const destinoIndex = mapaConexao[i] - 1; // mapaConexao cont√©m n√∫meros 1..32
    const valor = inputs[origemIndex].value.trim();
    if(outputs[destinoIndex]){
      outputs[destinoIndex].value = valor;
    }
  }
  atualizarContador();
}

/* Toggle remover/restaurar linhas vazias (um bot√£o s√≥) */
function toggleRemoveEmpty(){
  const outputs = colDirEl.querySelectorAll('.item');
  const btn = document.getElementById('btn-toggle');

  if(!removedToggle){
    hiddenIndices = [];
    outputs.forEach((item, idx)=>{
      const input = item.querySelector('input');
      if(!input.value || input.value.trim() === ''){
        hiddenIndices.push(idx);
        item.style.display = 'none';
      }
    });
    btn.textContent = 'Restaurar Linhas Vazias';
    removedToggle = true;
  } else {
    hiddenIndices.forEach(idx=>{
      if(outputs[idx]) outputs[idx].style.display = 'flex';
    });
    hiddenIndices = [];
    btn.textContent = 'Remover Linhas Vazias';
    removedToggle = false;
  }
  atualizarContador();
}

/* Restaurar todas (caso precise separadamente) */
function restaurarLinhas(){
  const outputs = colDirEl.querySelectorAll('.item');
  outputs.forEach(it => it.style.display = 'flex');
  hiddenIndices = [];
  document.getElementById('btn-toggle').textContent = 'Remover Linhas Vazias';
  removedToggle = false;
  atualizarContador();
}

/* Resetar todos os campos (esquerda e direita) */
function resetAll(){
  const allInputs = document.querySelectorAll('#coluna-esquerda input, #coluna-direita input');
  allInputs.forEach(i => i.value = '');
  // tamb√©m restaurar visibilidade
  restaurarLinhas();
  atualizarContador();
}

/* Copiar linhas preenchidas da direita - mostra mensagem discreta embaixo do √≠cone */
function copyRight(){
  const outputs = colDirEl.querySelectorAll('input[type="text"]');
  const lines = [];
  outputs.forEach((o, idx)=>{
    if(o.value && o.value.trim() !== ''){
      const label = o.parentElement.querySelector('span').textContent;
      lines.push(`${label}: ${o.value}`);
    }
  });
  const text = lines.join('\n');
  if(text.trim() === ''){
    showCopyMsg('Nada para copiar');
    return;
  }
  navigator.clipboard.writeText(text).then(()=>{
    showCopyMsg('Copiado');
  }).catch(()=>{
    showCopyMsg('Erro ao copiar');
  });
}

/* mensagem discreta abaixo do √≠cone */
function showCopyMsg(txt){
  const el = document.getElementById('copy-msg');
  el.textContent = txt;
  el.style.color = '#e6ffed';
  setTimeout(()=> el.textContent = '', 1800);
}

/* Toggle menu (esquerdo) */
function toggleMenu(){
  const pop = document.getElementById('menuPopup');
  pop.style.display = (pop.style.display === 'block') ? 'none' : 'block';
  // anima√ß√£o de "pulso" no bot√£o j√° feita via CSS animation on popup
}

/* Toggle save popup (direita) */
function toggleSave(){
  const sp = document.getElementById('savePopup');
  sp.style.display = (sp.style.display === 'block') ? 'none' : 'block';
}

/* Imprimir SOMENTE a lista da direita (formatada) */
function printOnlyRight(){
  // pega os labels+valores preenchidos (ou todos?) ‚Äî voc√™ pediu "apare√ßa as listas inteiras numa pagina so, e so a lista mesmo"
  const outputs = colDirEl.querySelectorAll('.item');
  const lines = [];
  outputs.forEach(it=>{
    const label = it.querySelector('span').textContent;
    const val = it.querySelector('input').value || '';
    lines.push(`${label} ‚Äî ${val}`);
  });

  const win = window.open('','_blank','width=800,height=800');
  const html = `
    <html><head><title>Impress√£o - Lista MAC 77</title>
    <style>body{font-family:monospace;padding:20px} pre{white-space:pre-wrap;}</style>
    </head><body><pre>${lines.join('\n')}</pre></body></html>`;
  win.document.write(html);
  win.document.close();
  win.focus();
  win.print();
  // win.close(); // opcional
}

/* Salvar: txt / pdf / excel */
async function saveAs(type){
  // coleta apenas linhas preenchidas (label: valor)
  const outputs = colDirEl.querySelectorAll('.item');
  const rows = [];
  outputs.forEach(it=>{
    const label = it.querySelector('span').textContent;
    const value = it.querySelector('input').value || '';
    rows.push({label, value});
  });

  // TXT
  if(type === 'txt'){
    const lines = rows.map(r => `${r.label}: ${r.value}`);
    const blob = new Blob([lines.join('\n')], {type:'text/plain;charset=utf-8'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'lista_mac_77.txt';
    a.click();
    toggleSave();
    return;
  }

  // PDF (jsPDF)
  if(type === 'pdf'){
    try{
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({unit:'pt', format:'a4'});
      let y = 40;
      doc.setFont('Courier');
      doc.setFontSize(11);
      rows.forEach(r=>{
        doc.text(`${r.label}: ${r.value}`, 40, y);
        y += 14;
        if(y > 800){ doc.addPage(); y = 40; }
      });
      doc.save('lista_mac_77.pdf');
    }catch(err){
      alert('Erro gerando PDF: ' + err);
    }
    toggleSave();
    return;
  }

  // Excel (SheetJS)
  if(type === 'excel'){
    try{
      const ws_data = [['Produto','Quantidade/Valor']];
      rows.forEach(r => ws_data.push([r.label, r.value]));
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(ws_data);
      XLSX.utils.book_append_sheet(wb, ws, 'MAC77');
      const wbout = XLSX.write(wb, {bookType:'xlsx', type:'array'});
      const blob = new Blob([wbout], {type:'application/octet-stream'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'lista_mac_77.xlsx';
      a.click();
    }catch(err){
      alert('Erro gerando Excel: ' + err);
    }
    toggleSave();
    return;
  }
}

/* iniciar */
montarInterface();

/* seguran√ßa: fecha popups ao clicar fora */
document.addEventListener('click', (e)=>{
  const menu = document.getElementById('menuPopup');
  const save = document.getElementById('savePopup');
  if(!e.target.closest('.menu-dropdown')) menu.style.display = 'none';
  if(!e.target.closest('.right-controls')) save.style.display = 'none';
});

/* atualiza contador sempre que transferir ou modificar manualmente (se quiser permitir edi√ß√£o direta dos outputs futuramente) */
document.addEventListener('input', (e)=>{
  // atualiza contador quando inputs da direita mudarem (elas s√£o readOnly por padr√£o)
  if(e.target.closest('#coluna-direita') || e.target.closest('#coluna-esquerda')){
    atualizarContador();
  }
});
</script>

</body>
</html>
