<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MAC 77 - Organizador de Lista</title>

<!-- jsPDF + SheetJS via CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<style>
  /* ===== base / tipografia ===== */
  :root {
    --azul:#007BFF;
    --amarelo:#FFD700;
    --vermelho:#b22222; /* vermelho escuro vivo */
  }
  html,body {
    height:100%;
  }
  body {
    font-family: monospace; /* manter monospace como voc√™ pediu */
    margin: 0;
    padding: 0;
    -webkit-font-smoothing:antialiased;
    color: #111;
  }

  /* ===== header ===== */
  header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    background: var(--azul);
    color: white;
    padding: 10px 14px;
    gap: 12px;
    position: sticky;
    top: 0;
    z-index: 999;
  }
  .menu-left, .menu-right {
    display:flex;
    gap: 8px;
    align-items:center;
  }
  .icon-btn {
    background: none;
    border: none;
    color: white;
    font-size: 18px;
    cursor: pointer;
    padding: 6px 8px;
    border-radius: 6px;
  }
  .icon-btn:hover { background: rgba(255,255,255,0.08); }

  /* dropdowns */
  .menu-dropdown { position: relative; }
  .menu-dropdown-content {
    display: none;
    position: absolute;
    top: calc(100% + 6px);
    left: 0;
    background: white;
    color: #111;
    border-radius: 6px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.15);
    min-width: 170px;
    max-width: calc(100vw - 40px);
    overflow: auto;
    z-index: 1200;
    padding: 6px 0;
    white-space: normal;
  }
  /* right-side dropdowns align to right */
  .menu-right .menu-dropdown-content { right: 0; left: auto; }

  .menu-dropdown-content a {
    display:block;
    padding: 8px 12px;
    color: #111;
    text-decoration: none;
    font-family: monospace;
  }
  .menu-dropdown-content a:hover { background: #f2f2f2; }

  /* ===== t√≠tulo com setas ===== */
  .titulo-nav {
    display:flex;
    justify-content:center;
    align-items:center;
    gap: 16px;
    margin: 14px 10px 8px;
  }
  .titulo-nav h1 {
    margin:0;
    font-size:18px;
    color:#111;
  }
  .titulo-nav a {
    color: var(--azul);
    text-decoration:none;
    font-size:22px;
    user-select:none;
  }

  /* ===== container duas colunas ===== */
  .container {
    display:flex;
    justify-content:center;
    gap: 48px;
    align-items:flex-start;
    padding: 10px 14px 24px;
    flex-wrap:wrap;
  }
  .column {
    display:flex;
    flex-direction:column;
    gap:6px;
    min-width: 300px;
    max-width: 420px;
    width: 100%;
  }

  .item {
    display:flex;
    align-items:center;
    gap:10px;
    padding:6px 8px;
    border-radius:6px;
  }
  .item span { flex:1; }
  .item input[type="text"] {
    width: 60px;
    padding:6px 6px;
    font-family: monospace;
    text-align:center;
    border:1px solid #ddd;
    border-radius:4px;
    background: white;
  }
  .item input[readonly] {
    background: #fafafa;
  }

  /* ===== middle controls ===== */
  #middle-controls {
    display:flex;
    flex-direction:column;
    gap:10px;
    align-items:center;
    justify-content:center;
    min-width:170px;
  }
  #middle-controls button {
    width:170px;
    padding:10px 12px;
    font-size:14px;
    border-radius:6px;
    border:none;
    cursor:pointer;
  }
  #middle-controls button:first-child { background:var(--azul); color:white; }
  .btn-amarelo { background: var(--amarelo); color:black; }
  .btn-amarelo:hover { background:#e6c200; }
  .btn-vermelho { background: var(--vermelho); color:white; }
  .btn-vermelho:hover { background:#8b1a1a; }

  /* ===== contador ===== */
  #contador-linhas { text-align:center; margin: 12px 0 24px; font-weight:700; }

  /* ===== mac-links (rodap√©) estilo em grid 4x) ===== */
  .mac-links {
    margin: 0 14px 30px;
    display: grid;
    grid-template-columns: repeat(4, 1fr); /* 4 colunas */
    gap: 10px;
    align-items:stretch;
  }
  .mac-links a {
    display:block;
    padding:8px 10px;
    background: #f7fbff;
    border:1px solid #e6f0ff;
    color: var(--azul);
    text-decoration:none;
    border-radius:6px;
    text-align:center;
    font-family: monospace;
  }
  .mac-links a:hover { background:#eef6ff; }

  /* responsivo: menos colunas em telas pequenas */
  @media (max-width:900px) {
    .container { gap: 20px; padding:10px; }
    .mac-links { grid-template-columns: repeat(2, 1fr); }
    #middle-controls { order: 2; }
  }
  @media (max-width:520px) {
    .container { flex-direction:column; align-items:center; }
    .column { max-width: 100%; min-width: auto; width: 100%; }
    .mac-links { grid-template-columns: repeat(1, 1fr); }
    #middle-controls { flex-direction:row; gap: 8px; }
    #middle-controls button { width: 120px; }
  }

  /* aviso c√≥pia discreto */
  #copy-notice {
    position: fixed;
    right: 18px;
    bottom: 18px;
    background: rgba(0,0,0,0.78);
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    display: none;
    z-index: 2000;
    font-family: monospace;
  }

  /* impress√£o: escondemos header, bot√µes extras e mac-links; for√ßamos monospace */
  @media print {
    header, .menu-dropdown-content, #middle-controls, .mac-links, #copy-notice { display: none !important; }
    body, html { font-family: monospace; }
    .container { gap: 0; padding: 0; }
    .column { box-shadow: none; border: none; }
    .column { min-width: 40%; }
  }

</style>
</head>
<body>

<header>
  <!-- ESQUERDA: hamburguer (menu), X (fechar), Home (menu inicial) -->
  <div class="menu-left">
    <div class="menu-dropdown">
      <button class="icon-btn" id="btn-hamburger" title="Menu (‚ò∞)" onclick="toggleMenu('dropdown-menu')">‚ò∞</button>
      <div class="menu-dropdown-content" id="dropdown-menu">
        <a href="#">P√°gina 1 (em breve)</a>
        <a href="#">P√°gina 2 (em breve)</a>
        <a href="#">P√°gina 3 (em breve)</a>
      </div>
    </div>

    <button class="icon-btn" id="btn-close" title="Fechar (‚ùå)" onclick="fecharPagina()">‚ùå</button>
    <button class="icon-btn" id="btn-home" title="Menu inicial (üè†)" onclick="voltarMenu()">üè†</button>
  </div>

  <!-- DIREITA: salvar (dropdown), impressora, copiar -->
  <div class="menu-right">
    <div class="menu-dropdown">
      <button class="icon-btn" id="btn-salvar" title="Salvar (üíæ)" onclick="toggleMenu('dropdown-save')">üíæ</button>
      <div class="menu-dropdown-content" id="dropdown-save" aria-labelledby="btn-salvar">
        <a href="#" onclick="salvarComoTXT(event)" title="Salvar como TXT">Salvar como TXT</a>
        <a href="#" onclick="salvarComoPDF(event)" title="Salvar como PDF">Salvar como PDF</a>
        <a href="#" onclick="salvarComoExcel(event)" title="Salvar como Excel">Salvar como Excel</a>
      </div>
    </div>

    <button class="icon-btn" id="btn-print" title="Imprimir (üñ®Ô∏è)" onclick="imprimirDireto()">
      üñ®Ô∏è
    </button>

    <button class="icon-btn" id="btn-copy" title="Copiar (üìã)" onclick="copiarDireita()">
      üìã
    </button>
  </div>
</header>

<!-- t√≠tulo com setas (seta esquerda omitida pois √© o primeiro) -->
<div class="titulo-nav">
  <span style="width:28px;display:inline-block"></span>
  <h1>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</h1>
  <a href="#" title="Pr√≥ximo MAC">‚Üí</a>
</div>

<!-- colunas e controles -->
<div class="container">
  <!-- COLUNA ESQUERDA -->
  <div class="column" id="coluna-esquerda"></div>

  <!-- CONTROLES DO MEIO -->
  <div id="middle-controls" aria-hidden="false">
    <button onclick="transferir()">‚Üí</button>
    <button onclick="alternarLinhas()" id="btn-linhas" class="btn-amarelo">Remover Linhas Vazias</button>
    <button onclick="resetarTudo()" class="btn-vermelho">Resetar Tudo</button>
  </div>

  <!-- COLUNA DIREITA -->
  <div class="column" id="coluna-direita"></div>
</div>

<!-- contador centralizado em baixo -->
<div id="contador-linhas">Linhas preenchidas: 0</div>

<!-- MACs em rodap√© (grid com 4 colunas) -->
<div class="mac-links" role="navigation" aria-label="Outros MACs">
  <a href="#">MAC 78 - Bairro Planalto (em breve)</a>
  <a href="#">MAC 79 - Romeu Duarte (em breve)</a>
  <a href="#">MAC 80 - Rua S√£o Geraldo / Centro 2 (em breve)</a>
  <a href="#">MAC 277 - Matriz (em breve)</a>
  <a href="#">MAC 853 - Concesso (em breve)</a>
  <a href="#">MAC 1249 - Jardim do Lago (em breve)</a>
  <a href="#">MAC Ara√∫jos (em breve)</a>
</div>

<!-- aviso discreto de c√≥pia -->
<div id="copy-notice">Copiado!</div>

<script>
/* ============================
   Dados (id√™nticos aos seus)
   ============================ */
const frasesEsquerda = [
  "P√ÉO DE QUEIJO RECHEADO FRANGO  PAC7KG",
  "P√ÉO DE QUEIJO  7KG",
  "P√ÉO FRANC√äS 6HRS PAC 7KG",
  "P√ÉO DE 4 HRS  7KG",
  "BAGUETE 6  HRS  7KG",
  "BISCOITO DOCE FRITO MP 1 KG",
  "BISCOITO DE QUEIJO MP 7 KG",
  "BISCOITO SEQUILHO MP MANGA",
  "BISCOITO TR√äS QUEIJOS MP 7 KG",
  "BOLO FUBA CREMOSO MP 1 UNIDADE",
  "BOLO MILHO MP 1 UNIDADE",
  "BROINHA DE FUBA DOCE MP 7 KG",
  "BROINHA BACON TEMPERADA MP 7 KG",
  "CROISSANT DE FRANGO MP 7 KG",
  "CROISSANT DE PRESUNTO MP 7KG",
  "P√ÉO DE QUEIJO MEIA LUA MP PAC COM 10 UNI",
  "P√ÉO DOCE C/CREME MP 7KG",
  "P√ÉO DOCE MP 7KG",
  "P√ÉO PANHOCA MP 7KG",
  "ROSCOVADO MP UNIDADE",
  "ROSCA CREME E COCO MP PAC COM 5 UNI",
  "ROSCA TRANCA MP PAC COM 10 UNID",
  "ROSCA TRANCINHA MP PAC 3KG",
  "ROSCA TRANCA REDONDA MP",
  "ROSQUINHA CANUDINHO DE QUEIJO MP PAC COM 7KG",
  "SALGADO COXINHA DE FRANGO MP 1 KG",
  "SALGADOS BOLINHA DE CARNE MP 1KG",
  "SALGADOS EMPADA DE FRANGO MP 1 KG",
  "SALGADOS ENROLADINHO PRESUNTO MP 1 KG",
  "SALGADOS PASTEL CATUPIRY MP 1 KG",
  "SALGADOS KIBE CATUPIRY MP 1 KG",
  "SONHO MP PAC 3 KG"
];

const frasesDireita = [
  "Baguete 06hrs 7kg",
  "Biscoitinho doce frito 1kg",
  "Biscoito de queijo 7kg",
  "Biscoito tr√™s queijos 7kg",
  "Bolinha de carne pequena 1kg",
  "Bolo cremoso de fub√° 1 unidade",
  "Bolo cremoso de milho 1 unidade",
  "Broinha de fub√° doce 7kg",
  "Broinha temperada com bacon 7kg",
  "Canudinho de queijo 7kg",
  "Caracol 7kg",
  "Carioca 7kg",
  "Coxinha de frango pequena 1kg",
  "Croissant de frango 7kg",
  "Croissant de presunto 7kg",
  "Empadinha de frango pequena 1kg",
  "Enroladinho de presunto pequeno 1kg",
  "Meia lua 1kg com 10 unidades",
  "Mistura biscoito sequilho 4kg",
  "Panhoca 7kg",
  "P√£o de queijo recheado frango 7kg",
  "P√£o de queijo tradicional 7kg",
  "P√£o franc√™s 04hrs 7kg",
  "P√£o franc√™s 06hrs 7kg",
  "Pastelzinho catupiry pequeno 1kg",
  "Quibe com catupiry pequeno 1kg",
  "Rosca creme e coco PCT 5 unidades",
  "Roscovado 1 unidade",
  "Sonho PCT 3kg",
  "Tran√ßa PCT 10 unidades",
  "Trancinha PCT 3kg",
  "Trancinha redonda"
];

// mapaConexao original (mantido id√™ntico)
const mapaConexao = [5,6,7,9,27,10,11,12,13,25,17,18,26,14,15,28,29,16,8,19,1,2,4,3,30,31,21,20,32,22,23,24];

/* ============================
   Constru√ß√£o da interface
   ============================ */
function montarInterface() {
  const colEsq = document.getElementById("coluna-esquerda");
  const colDir = document.getElementById("coluna-direita");
  colEsq.innerHTML = "";
  colDir.innerHTML = "";

  // Coluna esquerda (labels + inputs)
  frasesEsquerda.forEach((frase, i) => {
    const item = document.createElement("div");
    item.className = "item";

    const label = document.createElement("span");
    label.textContent = frase;

    const input = document.createElement("input");
    input.type = "text";
    input.dataset.index = i;

    // Permitir apenas n√∫meros (remove tudo que n√£o for d√≠gito)
    input.addEventListener("input", () => {
      const cur = input.value;
      const filtered = cur.replace(/[^0-9]/g, '');
      if (cur !== filtered) input.value = filtered;
    });

    // Enter move foco para pr√≥ximo input da esquerda
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        const next = colEsq.querySelector(`input[data-index="${i+1}"]`);
        if (next) next.focus();
      }
    });

    item.appendChild(label);
    item.appendChild(input);
    colEsq.appendChild(item);
  });

  // Coluna direita (labels + outputs readonly)
  frasesDireita.forEach((frase, i) => {
    const item = document.createElement("div");
    item.className = "item";

    const label = document.createElement("span");
    label.textContent = frase;

    const output = document.createElement("input");
    output.type = "text";
    output.readOnly = true;
    output.dataset.index = i;

    item.appendChild(label);
    item.appendChild(output);
    colDir.appendChild(item);
  });

  atualizarContagemDireita();
}

/* ============================
   Fun√ß√µes principais
   ============================ */

// Transfere valores da esquerda para a direita via mapaConexao (mesma l√≥gica do original)
function transferir() {
  const inputs = document.querySelectorAll("#coluna-esquerda input");
  const outputs = document.querySelectorAll("#coluna-direita input");
  mapaConexao.forEach((origem, destino) => {
    // origem √© 1-based no mapa original
    const valor = inputs[origem - 1] ? inputs[origem - 1].value.trim() : "";
    if (outputs[destino]) outputs[destino].value = valor;
  });
  atualizarContagemDireita();
}

// esconder/mostrar vazios
let linhasOcultas = false;
let elementosOcultos = [];

function alternarLinhas() {
  if (!linhasOcultas) {
    removerVazios();
    document.getElementById('btn-linhas').innerText = "Restaurar Linhas Vazias";
  } else {
    restaurarLinhas();
    document.getElementById('btn-linhas').innerText = "Remover Linhas Vazias";
  }
  linhasOcultas = !linhasOcultas;
}
function removerVazios() {
  const items = document.querySelectorAll("#coluna-direita .item");
  elementosOcultos = [];
  items.forEach(it => {
    const input = it.querySelector("input[type='text']");
    if (input && input.value.trim() === "") {
      it.style.display = "none";
      elementosOcultos.push(it);
    }
  });
}
function restaurarLinhas() {
  elementosOcultos.forEach(el => el.style.display = "flex");
  elementosOcultos = [];
}

// reset geral
function resetarTudo() {
  const inputs = document.querySelectorAll("input[type='text']");
  inputs.forEach(i => i.value = "");
  restaurarLinhas();
  atualizarContagemDireita();
}

// atualiza contador de linhas preenchidas (direita)
function atualizarContagemDireita() {
  const outputs = document.querySelectorAll("#coluna-direita input");
  let preenchidos = 0;
  outputs.forEach(out => {
    if (out.style.display !== "none" && out.value.trim() !== "") preenchidos++;
  });
  document.getElementById("contador-linhas").innerText = `Linhas preenchidas: ${preenchidos}`;
}

/* ============================
   Copiar / aviso discreto
   ============================ */
function copiarDireita() {
  const outputs = document.querySelectorAll("#coluna-direita input");
  const textos = [];
  outputs.forEach(output => {
    if (output.value.trim() !== "") {
      const label = output.parentElement.querySelector("span").textContent;
      textos.push(`${label}: ${output.value}`);
    }
  });
  const textoFinal = textos.join("\n");
  navigator.clipboard.writeText(textoFinal).then(() => {
    mostrarAvisoCopia();
  }).catch(() => {
    // silencioso se n√£o for poss√≠vel
  });
}
function mostrarAvisoCopia() {
  const el = document.getElementById("copy-notice");
  el.style.display = "block";
  setTimeout(() => { el.style.display = "none"; }, 2000);
}

/* ============================
   Salvar TXT / PDF / Excel
   ============================ */

function salvarComoTXT(e) {
  if (e) e.preventDefault();
  const outputs = document.querySelectorAll("#coluna-direita input");
  const linhas = [];
  outputs.forEach((output, i) => {
    if (output.value.trim() !== "") {
      const label = output.parentElement.querySelector("span").textContent;
      linhas.push(`${label}: ${output.value}`);
    }
  });
  baixarArquivo(linhas.join("\n"), "lista_mac_77.txt", "text/plain");
}

function salvarComoPDF(e) {
  if (e) e.preventDefault();
  // monta linhas (usando mapaConexao para pegar as frases da esquerda ligadas)
  const linhas = [];
  mapaConexao.forEach((origem, destino) => {
    const texto = frasesEsquerda[origem - 1] || "";
    const valor = document.querySelectorAll("#coluna-direita input")[destino] ? document.querySelectorAll("#coluna-direita input")[destino].value.trim() : "";
    if (valor !== "") linhas.push({texto, valor});
  });

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ unit: 'pt', format: 'a4' });
  doc.setFont("courier", "normal"); // monospace
  doc.setFontSize(11);

  const marginLeft = 40;
  const maxWidth = doc.internal.pageSize.getWidth() - marginLeft*2;
  let y = 40;
  doc.text("Lista MAC Bairro S√£o Geraldo - C√≥d. 77", marginLeft, y);
  y += 18;

  linhas.forEach(({texto, valor}, idx) => {
    // linha esquerda (produto) e valor alinhado depois
    const leftText = texto;
    const rightText = valor;
    // escreve o produto (envolve quebra autom√°tica)
    doc.text(leftText, marginLeft, y, { maxWidth });
    // escreve o valor mais √† direita na mesma linha (tentativa simples)
    doc.text(String(rightText), marginLeft + 360, y); // 360 offset para coluna de quantidade
    y += 14;
    // adicionar nova p√°gina se necess√°rio
    if (y > doc.internal.pageSize.getHeight() - 60) {
      doc.addPage();
      doc.setFontSize(11);
      doc.setFont("courier", "normal");
      y = 40;
    }
  });

  // contagem
  y += 8;
  doc.text(`Linhas preenchidas: ${linhas.length}`, marginLeft, y);

  doc.save("lista_mac_77.pdf");
}

function salvarComoExcel(e) {
  if (e) e.preventDefault();
  const outputs = document.querySelectorAll("#coluna-direita input");
  const data = [];
  // Cabe√ßalho A1 / B1
  data.push(["Produto", "Quantidade"]);
  outputs.forEach((output, i) => {
    if (output.value.trim() !== "") {
      const produto = output.parentElement.querySelector("span").textContent;
      const qtd = output.value.trim();
      data.push([produto, qtd]);
    }
  });
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);
  XLSX.utils.book_append_sheet(wb, ws, "MAC 77");
  XLSX.writeFile(wb, "lista_mac_77.xlsx");
}

/* ============================
   Impress√£o (janela com monospace e s√≥ conte√∫dos da coluna direita)
   ============================ */
function imprimirDireto() {
  // montar conte√∫do com t√≠tulo, lista dos preenchidos (coluna direita) e contagem
  const outputs = document.querySelectorAll("#coluna-direita input");
  const linhas = [];
  outputs.forEach((output) => {
    if (output.value.trim() !== "") {
      const label = output.parentElement.querySelector("span").textContent;
      linhas.push({ label, value: output.value.trim() });
    }
  });

  const html = `
  <!doctype html>
  <html>
  <head>
    <meta charset="utf-8"/>
    <title>Impress√£o - MAC 77</title>
    <style>
      body { font-family: monospace; padding: 20px; color: #111; }
      h1 { font-size: 16px; margin-bottom: 12px; }
      ul { padding-left:0; list-style:none; font-size:12px; }
      li { margin-bottom:6px; }
      .count { margin-top:12px; font-weight:700; }
    </style>
  </head>
  <body>
    <h1>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</h1>
    <ul>
      ${linhas.map(l => `<li>${l.label}: ${l.value}</li>`).join('')}
    </ul>
    <div class="count">Linhas preenchidas: ${linhas.length}</div>
  </body>
  </html>
  `;

  const win = window.open('', '_blank', 'width=800,height=600,noopener');
  if (!win) {
    alert('N√£o foi poss√≠vel abrir janela de impress√£o. Verifique bloqueadores de pop-up.');
    return;
  }
  win.document.open();
  win.document.write(html);
  win.document.close();
  // permite ao usu√°rio ver antes de imprimir
  win.focus();
  // chama print() (usu√°rio pode cancelar)
  setTimeout(() => { win.print(); }, 400);
}

/* ============================
   util: baixar arquivo
   ============================ */
function baixarArquivo(conteudo, nomeArquivo, tipo) {
  const blob = new Blob([conteudo], { type: tipo });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = nomeArquivo;
  document.body.appendChild(a);
  a.click();
  a.remove();
}

/* ============================
   dropdown / menus (n√£o ultrapassa a tela)
   ============================ */
function toggleMenu(id) {
  // fecha outros menus
  document.querySelectorAll('.menu-dropdown-content').forEach(el => {
    if (el.id !== id) { el.style.display = 'none'; el.style.opacity = 0; }
  });
  const el = document.getElementById(id);
  if (!el) return;
  if (el.style.display === 'block') {
    el.style.opacity = 0;
    setTimeout(() => el.style.display = 'none', 180);
  } else {
    // abre e ajusta posicao se necessario (max-width j√° impede overflow)
    el.style.display = 'block';
    el.style.opacity = 0;
    // deixa aparecer com transicao minima
    setTimeout(() => el.style.opacity = 1, 10);
  }
}

// fecha menus ao clicar fora
document.addEventListener('click', (ev) => {
  if (!ev.target.closest('.menu-dropdown')) {
    document.querySelectorAll('.menu-dropdown-content').forEach(el => {
      el.style.display = 'none';
      el.style.opacity = 0;
    });
  }
});

/* ============================
   Placeholders / a√ß√µes dos √≠cones esquerdo
   ============================ */
function fecharPagina() {
  // normalmente window.close() n√£o fecha janelas n√£o abertas por script
  // deixamos como retorno ao menu ou apenas limpamos os campos (exemplo)
  if (confirm('Fechar a p√°gina? (se estiver rodando via GitHub Pages, fechar pode n√£o funcionar)')) {
    try { window.close(); } catch(e) { /* ignore */ }
  }
}
function voltarMenu() {
  // comportamento original: alert ou redirecionamento; deixei como placeholder
  // vc pode trocar por window.location = '...';
  alert('Voltar ao menu inicial (substitua por redirecionamento se quiser).');
}

/* ============================
   Inicializa√ß√£o
   ============================ */
montarInterface();

/* Observa: sempre atualizar contagem depois de transferir manualmente (se necess√°rio) */
const transferBtn = document.querySelector('#middle-controls button');
if (transferBtn) transferBtn.addEventListener('click', () => {
  // j√° a fun√ß√£o transferir() atualiza a contagem, mas refor√ßamos
  setTimeout(() => atualizarContagemDireita(), 80);
});
</script>
</body>
</html>
