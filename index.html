<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MAC 77 - Organizador de Lista</title>
  <style>
    body {
      font-family: monospace;
      margin: 0;
      padding: 0;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 20px;
      background-color: #007BFF;
      border-bottom: 1px solid #ccc;
    }
    .menu-left, .menu-right {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    .menu-left button, .menu-right button {
      font-size: 16px;
      padding: 6px 10px;
      cursor: pointer;
      background: none;
      border: none;
      color: white;
    }
    .menu-dropdown {
      position: relative;
    }
    .menu-dropdown-content {
      display: none;
      position: absolute;
      top: 30px;
      right: 0;
      background-color: white;
      border: 1px solid #ccc;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.2);
      z-index: 1;
      min-width: 120px;
      animation: fadeIn 0.3s ease-in-out;
    }
    .menu-dropdown-content a {
      padding: 10px;
      display: block;
      text-decoration: none;
      color: black;
    }
    .menu-dropdown-content a:hover {
      background-color: #eee;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(-5px);}
      to {opacity: 1; transform: translateY(0);}
    }
    h1 {
      text-align: center;
      margin: 20px 0 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }
    .container {
      display: flex;
      justify-content: center;
      gap: 60px;
      align-items: flex-start;
      padding-bottom: 20px;
    }
    .column {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .item {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .item input[type="text"] {
      width: 40px;
      padding: 4px;
      font-family: monospace;
      text-align: center;
    }
    .item span {
      flex: 1;
    }
    #middle-controls {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
    }
    .btn-amarelo {
      background-color: #FFD700;
      color: black;
      border: none;
      padding: 10px 20px;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
    }
    .btn-amarelo:hover {
      background-color: #e6c200;
    }
    .btn-vermelho {
      background-color: #dc3545;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 14px;
      border-radius: 4px;
      cursor: pointer;
    }
    .btn-vermelho:hover {
      background-color: #c82333;
    }
    #middle-controls button:first-child {
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 4px;
    }
    .mac-links {
      text-align: left;
      margin: 20px auto;
      font-size: 14px;
      max-width: 800px;
      padding: 0 20px;
    }
    .mac-links-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-start;
    }
    .mac-links a {
      color: #007BFF;
      text-decoration: none;
      white-space: nowrap;
    }
    .mac-links a:hover {
      text-decoration: underline;
    }
    #contador-linhas {
      text-align: center;
      margin: 10px 0;
      font-weight: bold;
    }
    .notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 4px;
      z-index: 1000;
      display: none;
    }
    .nav-arrow {
      cursor: pointer;
      font-size: 24px;
    }
    .nav-arrow.disabled {
      opacity: 0.3;
      cursor: default;
    }
    @media print {
      header, .mac-links, #middle-controls button:not(:first-child) {
        display: none;
      }
      .container {
        flex-direction: row;
        gap: 40px;
      }
      .column {
        flex: 1;
      }
      #middle-controls {
        display: none;
      }
      h1 {
        margin-top: 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="menu-left">
      <button onclick="alert('Voltar ao menu')">‚ùå</button>
      <button onclick="alert('Menu inicial')">üè†</button>
    </div>
    <div class="menu-right">
      <div class="menu-dropdown">
        <button onclick="toggleSaveMenu()">üíæ</button>
        <div class="menu-dropdown-content" id="save-dropdown">
          <a href="#" onclick="salvarComoTexto()">Salvar como TXT</a>
          <a href="#" onclick="salvarComoPDF()">Salvar como PDF</a>
          <a href="#" onclick="salvarComoExcel()">Salvar como Excel</a>
        </div>
      </div>
      <button onclick="window.print()">üñ®Ô∏è</button>
      <button onclick="copiarDireita()">üìã</button>
      <div class="menu-dropdown">
        <button onclick="toggleMenu()">‚ò∞</button>
        <div class="menu-dropdown-content" id="dropdown">
          <a href="#">P√°gina 1 (em breve)</a>
          <a href="#">P√°gina 2 (em breve)</a>
          <a href="#">P√°gina 3 (em breve)</a>
        </div>
      </div>
    </div>
  </header>

  <div class="notification" id="notification">Copiado para a √°rea de transfer√™ncia!</div>

  <h1>
    <span class="nav-arrow disabled">‚Üê</span>
    Lista MAC Bairro S√£o Geraldo - C√≥d. 77
    <span class="nav-arrow" onclick="proximoMAC()">‚Üí</span>
  </h1>

  <div class="container">
    <!-- Coluna Esquerda -->
    <div class="column" id="coluna-esquerda"></div>

    <!-- Bot√µes -->
    <div id="middle-controls">
      <button onclick="transferir()">‚Üí</button>
      <button onclick="alternarLinhas()" id="btn-linhas" class="btn-amarelo">Remover Linhas Vazias</button>
      <button onclick="resetarTudo()" class="btn-vermelho">Resetar Tudo</button>
    </div>

    <!-- Coluna Direita -->
    <div class="column" id="coluna-direita"></div>
  </div>

  <div id="contador-linhas"></div>

  <div class="mac-links">
    <h3>Outros MACs:</h3>
    <div class="mac-links-container">
      <a href="#">MAC 78 - Bairro Planalto (em breve)</a> ‚Ä¢
      <a href="#">MAC 79 - Romeu Duarte (em breve)</a> ‚Ä¢
      <a href="#">MAC 80 - Rua S√£o Geraldo / Centro 2 (em breve)</a> ‚Ä¢
      <a href="#">MAC 277 - Matriz (em breve)</a> ‚Ä¢
      <a href="#">MAC 853 - Concesso (em breve)</a> ‚Ä¢
      <a href="#">MAC 1249 - Jardim do Lago (em breve)</a> ‚Ä¢
      <a href="#">MAC Ara√∫jos (em breve)</a>
    </div>
  </div>

  <script>
    const frasesEsquerda = [
      "P√ÉO DE QUEIJO RECHEADO FRANGO  PAC7KG",
      "P√ÉO DE QUEIJO  7KG",
      "P√ÉO FRANC√äS 6HRS PAC 7KG",
      "P√ÉO DE 4 HRS  7KG",
      "BAGUETE 6  HRS  7KG",
      "BISCOITO DOCE FRITO MP 1 KG",
      "BISCOITO DE QUEIJO MP 7 KG",
      "BISCOITO SEQUILHO MP MANGA",
      "BISCOITO TR√äS QUEIJOS MP 7 KG",
      "BOLO FUBA CREMOSO MP 1 UNIDADE",
      "BOLO MILHO MP 1 UNIDADE",
      "BROINHA DE FUBA DOCE MP 7 KG",
      "BROINHA BACON TEMPERADA MP 7 KG",
      "CROISSANT DE FRANGO MP 7 KG",
      "CROISSANT DE PRESUNTO MP 7KG",
      "P√ÉO DE QUEIJO MEIA LUA MP PAC COM 10 UNI",
      "P√ÉO DOCE C/CREME MP 7KG",
      "P√ÉO DOCE MP 7KG",
      "P√ÉO PANHOCA MP 7KG",
      "ROSCOVADO MP UNIDADE",
      "ROSCA CREME E COCO MP PAC COM 5 UNI",
      "ROSCA TRANCA MP PAC COM 10 UNID",
      "ROSCA TRANCINHA MP PAC 3KG",
      "ROSCA TRANCA REDONDA MP",
      "ROSQUINHA CANUDINHO DE QUEIJO MP PAC COM 7KG",
      "SALGADO COXINHA DE FRANGO MP 1 KG",
      "SALGADOS BOLINHA DE CARNE MP 1KG",
      "SALGADOS EMPADA DE FRANGO MP 1 KG",
      "SALGADOS ENROLADINHO PRESUNTO MP 1 KG",
      "SALGADOS PASTEL CATUPIRY MP 1 KG",
      "SALGADOS KIBE CATUPIRY MP 1 KG",
      "SONHO MP PAC 3 KG"
    ];

    const frasesDireita = [
      "Baguete 06hrs 7kg",
      "Biscoitinho doce frito 1kg",
      "Biscoito de queijo 7kg",
      "Biscoito tr√™s queijos 7kg",
      "Bolinha de carne pequena 1kg",
      "Bolo cremoso de fub√° 1 unidade",
      "Bolo cremoso de milho 1 unidade",
      "Broinha de fub√° doce 7kg",
      "Broinha temperada com bacon 7kg",
      "Canudinho de queijo 7kg",
      "Caracol 7kg",
      "Carioca 7kg",
      "Coxinha de frango pequena 1kg",
      "Croissant de frango 7kg",
      "Croissant de presunto 7kg",
      "Empadinha de frango pequena 1kg",
      "Enroladinho de presunto pequeno 1kg",
      "Meia lua 1kg com 10 unidades",
      "Mistura biscoito sequilho 4kg",
      "Panhoca 7kg",
      "P√£o de queijo recheado frango 7kg",
      "P√£o de queijo tradicional 7kg",
      "P√£o franc√™s 04hrs 7kg",
      "P√£o franc√™s 06hrs 7kg",
      "Pastelzinho catupiry pequeno 1kg",
      "Quibe com catupiry pequeno 1kg",
      "Rosca creme e coco PCT 5 unidades",
      "Roscovado 1 unidade",
      "Sonho PCT 3kg",
      "Tran√ßa PCT 10 unidades",
      "Trancinha PCT 3kg",
      "Trancinha redonda"
    ];

    const mapaConexao = [21, 22, 24, 23, 1, 2, 3, 19, 4, 5, 12, 13, 6, 14, 15, 7, 16, 17, 8, 20, 9, 10, 11, 25, 26, 27, 28, 29, 30, 31, 32, 18];

    function montarInterface() {
      const colEsq = document.getElementById("coluna-esquerda");
      const colDir = document.getElementById("coluna-direita");
      colEsq.innerHTML = "";
      colDir.innerHTML = "";

      frasesEsquerda.forEach((frase, i) => {
        const item = document.createElement("div");
        item.className = "item";

        const input = document.createElement("input");
        input.type = "text";
        input.dataset.index = i;
        input.addEventListener("keydown", function(e) {
          if (e.key === "Enter") {
            e.preventDefault();
            const nextInput = document.querySelector(`#coluna-esquerda input[data-index="${i+1}"]`);
            if (nextInput) nextInput.focus();
          }
          
          // Permitir apenas n√∫meros, backspace e delete
          if (!/[0-9]/.test(e.key) {
            if (!["Backspace", "Delete", "ArrowLeft", "ArrowRight", "Tab", "Enter"].includes(e.key)) {
              e.preventDefault();
            }
          }
        });

        const label = document.createElement("span");
        label.textContent = frase;

        item.appendChild(label);
        item.appendChild(input);
        colEsq.appendChild(item);
      });

      frasesDireita.forEach((frase, i) => {
        const item = document.createElement("div");
        item.className = "item";

        const label = document.createElement("span");
        label.textContent = frase;

        const output = document.createElement("input");
        output.type = "text";
        output.readOnly = true;
        output.dataset.index = i;

        item.appendChild(label);
        item.appendChild(output);
        colDir.appendChild(item);
      });
    }

    function transferir() {
      const inputs = document.querySelectorAll("#coluna-esquerda input");
      const outputs = document.querySelectorAll("#coluna-direita input");

      // Limpar todos os outputs primeiro
      outputs.forEach(output => {
        output.value = "";
      });

      // Preencher de acordo com o mapeamento
      mapaConexao.forEach((origem, destino) => {
        const valor = inputs[origem - 1].value.trim();
        if (valor) {
          outputs[destino].value = valor;
        }
      });

      atualizarContagemDireita();
    }

    function removerVazios() {
      const colDir = document.getElementById("coluna-direita");
      const items = colDir.querySelectorAll(".item");

      items.forEach(item => {
        const input = item.querySelector("input[type='text']");
        if (input && input.value.trim() === "") {
          item.style.display = "none";
        }
      });
    }

    function restaurarLinhas() {
      const colDir = document.getElementById("coluna-direita");
      const items = colDir.querySelectorAll(".item");

      items.forEach(item => {
        item.style.display = "flex";
      });
    }

    function copiarDireita() {
      const outputs = document.querySelectorAll("#coluna-direita input");
      const textos = [];
      outputs.forEach((output, i) => {
        if (output.value.trim() !== "" && output.parentElement.style.display !== "none") {
          const label = output.parentElement.querySelector("span").textContent;
          textos.push(`${label}: ${output.value}`);
        }
      });
      const textoFinal = textos.join("\n");
      navigator.clipboard.writeText(textoFinal)
        .then(() => {
          const notification = document.getElementById("notification");
          notification.style.display = "block";
          setTimeout(() => {
            notification.style.display = "none";
          }, 2000);
        })
        .catch(err => console.error("Erro ao copiar: ", err));
    }

    function salvarComoTexto() {
      const outputs = document.querySelectorAll("#coluna-direita input");
      const textos = [];
      outputs.forEach((output, i) => {
        if (output.value.trim() !== "" && output.parentElement.style.display !== "none") {
          const label = output.parentElement.querySelector("span").textContent;
          textos.push(`${label}: ${output.value}`);
        }
      });
      const blob = new Blob([textos.join("\n")], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'lista_mac_77.txt';
      a.click();
    }

    function salvarComoPDF() {
      window.print();
    }

    function salvarComoExcel() {
      const outputs = document.querySelectorAll("#coluna-direita input");
      let csvContent = "Produto,Quantidade\n";
      
      outputs.forEach((output, i) => {
        if (output.value.trim() !== "" && output.parentElement.style.display !== "none") {
          const label = output.parentElement.querySelector("span").textContent;
          csvContent += `"${label}","${output.value}"\n`;
        }
      });
      
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement("a");
      const url = URL.createObjectURL(blob);
      link.setAttribute("href", url);
      link.setAttribute("download", "lista_mac_77.csv");
      link.style.visibility = 'hidden';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    let linhasOcultas = false;
    let elementosOcultos = [];

    function alternarLinhas() {
      if (!linhasOcultas) {
        removerVazios();
        document.getElementById('btn-linhas').innerText = "Restaurar Linhas Vazias";
      } else {
        restaurarLinhas();
        document.getElementById('btn-linhas').innerText = "Remover Linhas Vazias";
      }
      linhasOcultas = !linhasOcultas;
      atualizarContagemDireita();
    }

    function resetarTudo() {
      const inputs = document.querySelectorAll("#coluna-esquerda input[type='text']");
      inputs.forEach((input) => {
        input.value = "";
      });
      
      const outputs = document.querySelectorAll("#coluna-direita input[type='text']");
      outputs.forEach((output) => {
        output.value = "";
      });
      
      restaurarLinhas();
      linhasOcultas = false;
      document.getElementById('btn-linhas').innerText = "Remover Linhas Vazias";
      atualizarContagemDireita();
    }

    function atualizarContagemDireita() {
      const outputs = document.querySelectorAll("#coluna-direita input");
      let preenchidos = 0;
      outputs.forEach(output => {
        if (output.parentElement.style.display !== "none" && output.value.trim() !== "") preenchidos++;
      });
      document.getElementById("contador-linhas").innerText = `Linhas preenchidas: ${preenchidos}`;
    }

    function toggleMenu() {
      const dropdown = document.getElementById('dropdown');
      if (dropdown.style.display === 'block') {
        dropdown.style.opacity = 0;
        setTimeout(() => {
          dropdown.style.display = 'none';
        }, 200);
      } else {
        dropdown.style.display = 'block';
        setTimeout(() => {
          dropdown.style.opacity = 1;
        }, 0);
      }
    }

    function toggleSaveMenu() {
      const dropdown = document.getElementById('save-dropdown');
      if (dropdown.style.display === 'block') {
        dropdown.style.opacity = 0;
        setTimeout(() => {
          dropdown.style.display = 'none';
        }, 200);
      } else {
        dropdown.style.display = 'block';
        setTimeout(() => {
          dropdown.style.opacity = 1;
        }, 0);
      }
    }

    function proximoMAC() {
      // Aqui voc√™ pode adicionar a l√≥gica para ir para o pr√≥ximo MAC
      alert("Pr√≥ximo MAC (em breve)");
    }

    // Fechar menus ao clicar fora
    document.addEventListener('click', function(event) {
      if (!event.target.matches('.menu-dropdown button')) {
        const dropdowns = document.querySelectorAll('.menu-dropdown-content');
        dropdowns.forEach(dropdown => {
          if (dropdown.style.display === 'block') {
            dropdown.style.opacity = 0;
            setTimeout(() => {
              dropdown.style.display = 'none';
            }, 200);
          }
        });
      }
    });

    montarInterface();
  </script>
</body>
</html>
