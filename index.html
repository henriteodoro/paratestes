<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</title>

  <!-- libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    :root{
      --azul:#007BFF;
      --amarelo:#FFD700;
      --bg:#f5f7fb;
      --mono: monospace;
    }
    body{ font-family: Arial, sans-serif; margin:0; background:var(--bg); color:#111; }
    header{
      display:flex; justify-content:space-between; align-items:center;
      background:var(--azul); color:#fff; padding:10px 16px; position:relative;
    }
    .left-controls, .right-controls{ display:flex; gap:8px; align-items:center; }
    .icon-btn{
      background:none; border:none; color:#fff; cursor:pointer; font-size:18px; padding:6px;
      position:relative;
    }
    /* tooltip */
    .icon-btn[data-tooltip]:hover::after{
      content: attr(data-tooltip);
      position:absolute; bottom:-30px; left:50%; transform:translateX(-50%);
      background:rgba(0,0,0,0.75); color:#fff; padding:4px 8px; border-radius:4px; font-size:12px; white-space:nowrap;
    }

    /* dropdowns */
    .menu-popup, .save-popup{
      position:absolute; top:44px; left:0; background:#fff; color:#111; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.12);
      display:none; min-width:160px; overflow:hidden; z-index:50;
      animation:fadeIn .22s ease;
    }
    .save-popup{ right:10px; left:auto; }
    .menu-popup a, .save-popup div{ display:block; padding:8px 10px; text-decoration:none; color:#111; cursor:pointer; border-bottom:1px solid #eee; }
    .menu-popup a:last-child, .save-popup div:last-child { border-bottom: none; }
    .menu-popup a:hover, .save-popup div:hover { background:#f2f6ff; }

    @keyframes fadeIn{ from{opacity:0; transform:translateY(-6px)} to{opacity:1; transform:none} }

    h1{ text-align:center; margin:14px 0; font-size:18px; color:#222; }

    .wrapper{ max-width:1100px; margin:16px auto; padding:0 12px 40px; }

    .container{ display:flex; gap:36px; justify-content:center; align-items:flex-start; flex-wrap:wrap; }

    .column{ display:flex; flex-direction:column; gap:8px; min-width:340px; width:380px; background:#fff; padding:12px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.06); }
    .col-title{ font-weight:bold; text-align:center; margin-bottom:6px; }
    .item{ display:flex; align-items:center; gap:8px; padding:6px 4px; }
    .item span{ flex:1; font-family:var(--mono); font-size:13px; color:#222; }
    .item input[type="text"]{ width:80px; padding:6px 8px; font-family:var(--mono); font-size:13px; border:1px solid #ddd; border-radius:4px; text-align:center; }
    .item input[readonly]{ background:#fafafa; color:#222; }

    /* middle controls */
    #middle-controls{ display:flex; flex-direction:column; gap:10px; align-items:center; margin-top:40px; }
    .btn-arrow{ background:var(--azul); color:#fff; border:none; padding:10px 14px; font-size:18px; border-radius:6px; cursor:pointer; }
    .btn-yellow{ background:var(--amarelo); color:#000; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; }
    .btn-reset{ background:#d9534f; color:#fff; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; }

    #contador-linhas{ text-align:center; font-weight:bold; margin-bottom:6px; }

    /* mac-links in one line and left */
    .mac-links{ display:flex; gap:12px; align-items:center; justify-content:flex-start; margin-top:20px; font-family:var(--mono); padding-left:8px; overflow-x:auto; white-space:nowrap; }
    .mac-links a{ display:inline-block; margin-right:12px; color:var(--azul); text-decoration:none; }
    .mac-links a:hover{ text-decoration:underline; }

    /* print rules - hide header and footer when printing */
    @media print{
      header, .mac-links { display:none !important; }
      body{ background:#fff; }
    }

    /* small screens */
    @media (max-width:980px){
      .container{ flex-direction:column; align-items:center; }
      .column{ width:100%; max-width:720px; }
    }
  </style>
</head>
<body>

  <header>
    <div class="left-controls">
      <div style="position:relative;">
        <button class="icon-btn" data-tooltip="Menu" onclick="toggleMenu()">üìÇ</button>
        <div id="menuPopup" class="menu-popup" style="left:0;">
          <a href="#" onclick="alert('Em breve')">P√°gina 1 (em breve)</a>
          <a href="#" onclick="alert('Em breve')">P√°gina 2 (em breve)</a>
          <a href="#" onclick="alert('Em breve')">P√°gina 3 (em breve)</a>
        </div>
      </div>

      <button class="icon-btn" data-tooltip="Fechar" onclick="alert('Fechar (em breve)')">‚úñ</button>
      <button class="icon-btn" data-tooltip="Menu inicial" onclick="alert('Menu inicial (em breve)')">üè†</button>
    </div>

    <h1>Lista MAC Bairro S√£o Geraldo - C√≥d. 77</h1>

    <div class="right-controls" style="position:relative;">
      <button class="icon-btn" data-tooltip="Salvar" onclick="toggleSave()">üíæ</button>
      <div id="savePopup" class="save-popup">
        <div onclick="saveAs('txt')">Salvar como TXT</div>
        <div onclick="saveAs('pdf')">Salvar como PDF</div>
        <div onclick="saveAs('excel')">Salvar como Excel</div>
      </div>

      <button class="icon-btn" data-tooltip="Imprimir" onclick="window.print()">üñ®Ô∏è</button>
      <button class="icon-btn" data-tooltip="Copiar" onclick="copyRight()">üìã</button>
    </div>
  </header>

  <div class="wrapper">
    <div class="container">
      <!-- coluna esquerda -->
      <div class="column" id="coluna-esquerda">
        <div class="col-title">Coluna Esquerda (entrada)</div>
        <!-- itens gerados via JS -->
      </div>

      <!-- middle -->
      <div id="middle-controls">
        <button class="btn-arrow" id="btn-transfer" title="Transferir" onclick="transferir()">‚Üí</button>
        <button class="btn-yellow" id="btn-toggle" onclick="toggleRemoveEmpty()">Remover Linhas Vazias</button>
        <button class="btn-reset" onclick="resetAll()">Resetar Tudo</button>
      </div>

      <!-- coluna direita -->
      <div class="column" id="coluna-direita-wrapper">
        <div id="contador-linhas">Linhas Preenchidas: 0</div>
        <div class="column" id="coluna-direita">
          <div style="font-size:12px;color:#666;text-align:center;margin-bottom:6px;">Coluna Direita (sa√≠da)</div>
          <!-- itens gerados via JS -->
        </div>
      </div>
    </div>

    <!-- print area hidden normally (not necessary but kept) -->
    <div id="print-area" style="display:none;"></div>
  </div>

  <!-- footer macs one line more to left -->
  <div class="mac-links" aria-hidden="false">
    <a href="#" onclick="alert('Em breve')">MAC 78 - Bairro Planalto</a>
    <a href="#" onclick="alert('Em breve')">MAC 79 - Romeu Duarte</a>
    <a href="#" onclick="alert('Em breve')">MAC 80 - Rua S√£o Geraldo / Centro 2</a>
    <a href="#" onclick="alert('Em breve')">MAC 277 - Matriz</a>
    <a href="#" onclick="alert('Em breve')">MAC 853 - Concesso</a>
    <a href="#" onclick="alert('Em breve')">MAC 1249 - Jardim do Lago</a>
    <a href="#" onclick="alert('Em breve')">MAC Ara√∫jos</a>
  </div>

<script>
/* ===== dados ===== */
const frasesEsquerda = [
  "P√ÉO DE QUEIJO RECHEADO FRANGO  PAC7KG",
  "P√ÉO DE QUEIJO  7KG",
  "P√ÉO FRANC√äS 6HRS PAC 7KG",
  "P√ÉO DE 4 HRS  7KG",
  "BAGUETE 6  HRS  7KG",
  "BISCOITO DOCE FRITO MP 1 KG",
  "BISCOITO DE QUEIJO MP 7 KG",
  "BISCOITO SEQUILHO MP MANGA",
  "BISCOITO TR√äS QUEIJOS MP 7 KG",
  "BOLO FUBA CREMOSO MP 1 UNIDADE",
  "BOLO MILHO MP 1 UNIDADE",
  "BROINHA DE FUBA DOCE MP 7 KG",
  "BROINHA BACON TEMPERADA MP 7 KG",
  "CROISSANT DE FRANGO MP 7 KG",
  "CROISSANT DE PRESUNTO MP 7KG",
  "P√ÉO DE QUEIJO MEIA LUA MP PAC COM 10 UNI",
  "P√ÉO DOCE C/CREME MP 7KG",
  "P√ÉO DOCE MP 7KG",
  "P√ÉO PANHOCA MP 7KG",
  "ROSCOVADO MP UNIDADE",
  "ROSCA CREME E COCO MP PAC COM 5 UNI",
  "ROSCA TRANCA MP PAC COM 10 UNID",
  "ROSCA TRANCINHA MP PAC 3KG",
  "ROSCA TRANCA REDONDA MP",
  "ROSQUINHA CANUDINHO DE QUEIJO MP PAC COM 7KG",
  "SALGADO COXINHA DE FRANGO MP 1 KG",
  "SALGADOS BOLINHA DE CARNE MP 1KG",
  "SALGADOS EMPADA DE FRANGO MP 1 KG",
  "SALGADOS ENROLADINHO PRESUNTO MP 1 KG",
  "SALGADOS PASTEL CATUPIRY MP 1 KG",
  "SALGADOS KIBE CATUPIRY MP 1 KG",
  "SONHO MP PAC 3 KG"
];

const frasesDireita = [
  "Baguete 06hrs 7kg",
  "Biscoitinho doce frito 1kg",
  "Biscoito de queijo 7kg",
  "Biscoito tr√™s queijos 7kg",
  "Bolinha de carne pequena 1kg",
  "Bolo cremoso de fub√° 1 unidade",
  "Bolo cremoso de milho 1 unidade",
  "Broinha de fub√° doce 7kg",
  "Broinha temperada com bacon 7kg",
  "Canudinho de queijo 7kg",
  "Caracol 7kg",
  "Carioca 7kg",
  "Coxinha de frango pequena 1kg",
  "Croissant de frango 7kg",
  "Croissant de presunto 7kg",
  "Empadinha de frango pequena 1kg",
  "Enroladinho de presunto pequeno 1kg",
  "Meia lua 1kg com 10 unidades",
  "Mistura biscoito sequilho 4kg",
  "Panhoca 7kg",
  "P√£o de queijo recheado frango 7kg",
  "P√£o de queijo tradicional 7kg",
  "P√£o franc√™s 04hrs 7kg",
  "P√£o franc√™s 06hrs 7kg",
  "Pastelzinho catupiry pequeno 1kg",
  "Quibe com catupiry pequeno 1kg",
  "Rosca creme e coco PCT 5 unidades",
  "Roscovado 1 unidade",
  "Sonho PCT 3kg",
  "Tran√ßa PCT 10 unidades",
  "Trancinha PCT 3kg",
  "Trancinha redonda"
];

const mapaConexao = [5,6,7,9,27,10,11,12,13,25,17,18,26,14,15,28,29,16,8,19,1,2,4,3,30,31,21,20,32,22,23,24];

/* ===== estado ===== */
let hiddenIndices = [];
let removedToggle = false;

/* monta interface */
function montarInterface(){
  const colEsq = document.getElementById('coluna-esquerda');
  const colDir = document.getElementById('coluna-direita');
  colEsq.innerHTML = '<div style="font-size:12px;color:#666;text-align:center;margin-bottom:6px;">Coluna Esquerda (preencha)</div>';
  colDir.innerHTML = '';
  for(let i=0;i<frasesEsquerda.length;i++){
    // esquerda
    const divL = document.createElement('div'); divL.className='item';
    const spanL = document.createElement('span'); spanL.textContent = frasesEsquerda[i];
    const inputL = document.createElement('input'); inputL.type='text'; inputL.dataset.index=i;
    divL.appendChild(spanL); divL.appendChild(inputL); colEsq.appendChild(divL);

    // direita
    const divR = document.createElement('div'); divR.className='item';
    const spanR = document.createElement('span'); spanR.textContent = frasesDireita[i];
    const out = document.createElement('input'); out.type='text'; out.readOnly=true; out.dataset.index=i;
    divR.appendChild(spanR); divR.appendChild(out); colDir.appendChild(divR);
  }
  atualizarContador();
}

/* atualizar contador de preenchidos na direita */
function atualizarContador(){
  const outs = document.querySelectorAll('#coluna-direita input[type="text"]');
  const count = Array.from(outs).filter(o => o.value && o.value.trim() !== '').length;
  document.getElementById('contador-linhas').innerText = `Linhas Preenchidas: ${count}`;
}

/* transferir usando mapaConexao */
function transferir(){
  const ins = document.querySelectorAll('#coluna-esquerda input[type="text"]');
  const outs = document.querySelectorAll('#coluna-direita input[type="text"]');
  for(let i=0;i<mapaConexao.length && i<ins.length;i++){
    const origem = i;
    const destino = mapaConexao[i] - 1;
    const val = ins[origem].value.trim();
    if(outs[destino]) outs[destino].value = val;
  }
  atualizarContador();
}

/* toggle remover/restaurar */
function toggleRemoveEmpty(){
  const outsItems = document.querySelectorAll('#coluna-direita .item');
  const btn = document.getElementById('btn-toggle');
  if(!removedToggle){
    hiddenIndices = [];
    outsItems.forEach((it, idx)=>{
      const input = it.querySelector('input');
      if(!input.value || input.value.trim() === ''){
        hiddenIndices.push(idx);
        it.style.display = 'none';
      }
    });
    btn.innerText = 'Restaurar Linhas Vazias';
    removedToggle = true;
  } else {
    hiddenIndices.forEach(idx => { if(outsItems[idx]) outsItems[idx].style.display = 'flex'; });
    hiddenIndices = [];
    btn.innerText = 'Remover Linhas Vazias';
    removedToggle = false;
  }
  atualizarContador();
}

/* resetar tudo */
function resetAll(){
  const all = document.querySelectorAll('#coluna-esquerda input, #coluna-direita input');
  all.forEach(i => i.value = '');
  // restaurar visibilidade
  document.querySelectorAll('#coluna-direita .item').forEach(it => it.style.display = 'flex');
  hiddenIndices = [];
  removedToggle = false;
  document.getElementById('btn-toggle').innerText = 'Remover Linhas Vazias';
  atualizarContador();
}

/* copiar (sem aviso) */
function copyRight(){
  const outs = document.querySelectorAll('#coluna-direita .item');
  const lines = [];
  outs.forEach(it => {
    const value = it.querySelector('input').value || '';
    if(value.trim() !== ''){
      const label = it.querySelector('span').textContent;
      lines.push(`${label}: ${value}`);
    }
  });
  const txt = lines.join('\n');
  if(txt.trim() === '') return; // nada a copiar
  navigator.clipboard.writeText(txt).catch(()=>{/* sil√™ncio em caso de erro */});
}

/* salvar: txt/pdf/excel */
async function saveAs(type){
  const outs = document.querySelectorAll('#coluna-direita .item');
  const rows = [];
  outs.forEach(it=>{
    const label = it.querySelector('span').textContent;
    const value = it.querySelector('input').value || '';
    if(value.trim() !== '') rows.push({label, value});
  });

  if(type === 'txt'){
    const lines = rows.map(r => `${r.label}: ${r.value}`);
    const blob = new Blob([lines.join('\n')], {type:'text/plain;charset=utf-8'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob); a.download = 'lista_mac_77.txt'; a.click();
    toggleSave(false);
    return;
  }

  if(type === 'pdf'){
    try{
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({unit:'pt', format:'a4'});
      doc.setFont('Courier');
      doc.setFontSize(11);
      let y = 40;
      rows.forEach(r=>{
        doc.text(`${r.label}: ${r.value}`, 40, y);
        y += 14;
        if(y > 760){ doc.addPage(); y = 40; }
      });
      doc.save('lista_mac_77.pdf');
    }catch(e){
      alert('Erro ao gerar PDF: ' + e);
    }
    toggleSave(false);
    return;
  }

  if(type === 'excel'){
    try{
      const aoa = [['Frase','Valor']];
      rows.forEach(r => aoa.push([r.label, r.value]));
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.aoa_to_sheet(aoa);
      XLSX.utils.book_append_sheet(wb, ws, 'MAC77');
      const wbout = XLSX.write(wb, {bookType:'xlsx', type:'array'});
      const blob = new Blob([wbout], {type:'application/octet-stream'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob); a.download = 'lista_mac_77.xlsx'; a.click();
    }catch(e){
      alert('Erro ao gerar Excel: ' + e);
    }
    toggleSave(false);
    return;
  }
}

/* salvar menu toggle */
function toggleSave(force){
  const el = document.getElementById('savePopup');
  if(typeof force === 'boolean'){
    el.style.display = force ? 'block' : 'none'; return;
  }
  el.style.display = (el.style.display === 'block') ? 'none' : 'block';
}

/* menu toggle */
function toggleMenu(){
  const el = document.getElementById('menuPopup');
  el.style.display = (el.style.display === 'block') ? 'none' : 'block';
}

/* fun√ß√£o imprimir: usa CSS @media print para esconder header/footer */
function imprimir(){
  window.print();
}

/* monta UI inicial */
montarInterface();

/* esconde popups ao clicar fora */
document.addEventListener('click', (e)=>{
  if(!e.target.closest('.left-controls') && !e.target.closest('#menuPopup')) document.getElementById('menuPopup').style.display = 'none';
  if(!e.target.closest('.right-controls') && !e.target.closest('#savePopup')) document.getElementById('savePopup').style.display = 'none';
});

/* atualiza contador quando trocar valores manualmente */
document.addEventListener('input', (e)=>{
  if(e.target.closest('#coluna-direita') || e.target.closest('#coluna-esquerda')) atualizarContador();
});
</script>

</body>
</html>
