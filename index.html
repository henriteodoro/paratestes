<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MAC 77 - Organizador de Lista</title>

<style>
  /* Reset e base */
  body {
    font-family: monospace;
    margin: 0; padding: 0;
  }
  header {
    background-color: #007BFF;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 20px;
  }
  .menu-left, .menu-right {
    display: flex;
    align-items: center;
    gap: 15px;
  }
  .menu-left button, .menu-right button {
    font-size: 16px;
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    padding: 6px 10px;
  }
  /* Dropdown geral */
  .menu-dropdown {
    position: relative;
  }
  .menu-dropdown-content {
    display: none;
    position: absolute;
    top: 35px;
    left: 0;
    background: white;
    border: 1px solid #ccc;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    min-width: 140px;
    z-index: 1000;
  }
  .menu-dropdown-content a {
    display: block;
    padding: 10px;
    text-decoration: none;
    color: black;
    white-space: nowrap;
  }
  .menu-dropdown-content a:hover {
    background: #eee;
  }
  /* BotÃµes centralizados */
  #middle-controls {
    display: flex;
    flex-direction: column;
    gap: 10px;
    justify-content: center;
  }
  #middle-controls button {
    width: 160px;
    font-size: 14px;
    padding: 10px 20px;
    border-radius: 4px;
    border: none;
    cursor: pointer;
  }
  #middle-controls button:first-child {
    background-color: #007BFF;
    color: white;
  }
  .btn-amarelo {
    background-color: #FFD700;
    color: black;
  }
  .btn-amarelo:hover {
    background-color: #e6c200;
  }
  .btn-vermelho {
    background-color: #b22222; /* vermelho escuro vivo */
    color: white;
  }
  .btn-vermelho:hover {
    background-color: #8b1a1a;
  }
  /* Container colunas */
  .container {
    display: flex;
    justify-content: center;
    gap: 60px;
    align-items: flex-start;
    padding-bottom: 20px;
  }
  .column {
    display: flex;
    flex-direction: column;
    gap: 6px;
    min-width: 300px;
  }
  .item {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .item input[type="text"] {
    width: 40px;
    padding: 4px;
    font-family: monospace;
    text-align: center;
  }
  .item span {
    flex: 1;
  }
  /* TÃ­tulo e setas */
  .titulo-nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin: 20px 0 10px;
  }
  .titulo-nav a {
    font-size: 24px;
    color: #007BFF;
    text-decoration: none;
    user-select: none;
  }
  .titulo-nav a:hover {
    text-decoration: underline;
  }
  /* RodapÃ© MACs */
  .mac-links {
    padding: 10px 20px;
    font-size: 14px;
    display: flex;
    gap: 15px;
    flex-wrap: nowrap;
    overflow-x: auto;
    white-space: nowrap;
    justify-content: flex-start;
  }
  .mac-links a {
    color: #007BFF;
    text-decoration: none;
  }
  .mac-links a:hover {
    text-decoration: underline;
  }
  /* Contador linhas */
  #contador-linhas {
    font-weight: bold;
    text-align: center;
    margin-bottom: 30px;
  }
  /* Aviso de cÃ³pia */
  #copy-notice {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: rgba(0,0,0,0.7);
    color: white;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 14px;
    display: none;
    z-index: 9999;
  }
  /* ImpressÃ£o */
  @media print {
    header, .mac-links, #middle-controls, #copy-notice {
      display: none !important;
    }
    body {
      margin: 1cm;
    }
    .container {
      justify-content: space-between;
      gap: 20px;
    }
    .column {
      min-width: 40%;
    }
    #contador-linhas {
      margin-top: 20px;
      font-size: 16px;
    }
  }
</style>

<!-- Bibliotecas externas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

</head>
<body>

<header>
  <!-- Menu esquerdo -->
  <div class="menu-left">
    <div class="menu-dropdown">
      <button onclick="toggleMenu('dropdown-menu')">ðŸ“‚ Menu</button>
      <div class="menu-dropdown-content" id="dropdown-menu">
        <a href="#">PÃ¡gina 1 (em breve)</a>
        <a href="#">PÃ¡gina 2 (em breve)</a>
        <a href="#">PÃ¡gina 3 (em breve)</a>
      </div>
    </div>
  </div>

  <!-- Menu direito -->
  <div class="menu-right">
    <div class="menu-dropdown">
      <button onclick="toggleMenu('dropdown-save')">ðŸ’¾</button>
      <div class="menu-dropdown-content" id="dropdown-save">
        <a href="#" onclick="salvarComoTXT(event)">Salvar como TXT</a>
        <a href="#" onclick="salvarComoPDF(event)">Salvar como PDF</a>
        <a href="#" onclick="salvarComoExcel(event)">Salvar como Excel</a>
      </div>
    </div>
    <div class="menu-dropdown">
      <button onclick="toggleMenu('dropdown-hamburger')">â˜°</button>
      <div class="menu-dropdown-content" id="dropdown-hamburger">
        <a href="#">OpÃ§Ã£o 1</a>
        <a href="#">OpÃ§Ã£o 2</a>
      </div>
    </div>
  </div>
</header>

<!-- TÃ­tulo com setas -->
<div class="titulo-nav">
  <!-- Nenhuma seta esquerda pois Ã© o primeiro -->
  <span style="width:30px;"></span>
  <h1>Lista MAC Bairro SÃ£o Geraldo - CÃ³d. 77</h1>
  <a href="#" title="PrÃ³ximo MAC">â†’</a>
</div>

<!-- Container das colunas e controles -->
<div class="container">
  <!-- Coluna esquerda -->
  <div class="column" id="coluna-esquerda"></div>

  <!-- BotÃµes do meio -->
  <div id="middle-controls">
    <button onclick="transferir()">â†’</button>
    <button onclick="alternarLinhas()" id="btn-linhas" class="btn-amarelo">Remover Linhas Vazias</button>
    <button onclick="resetarTudo()" class="btn-vermelho">Resetar Tudo</button>
  </div>

  <!-- Coluna direita -->
  <div class="column" id="coluna-direita"></div>
</div>

<!-- Contador linhas -->
<div id="contador-linhas">Linhas preenchidas: 0</div>

<!-- Links prÃ³ximos MACs -->
<div class="mac-links">
  <a href="#">MAC 78 - Bairro Planalto (em breve)</a>
  <a href="#">MAC 79 - Romeu Duarte (em breve)</a>
  <a href="#">MAC 80 - Rua SÃ£o Geraldo / Centro 2 (em breve)</a>
  <a href="#">MAC 277 - Matriz (em breve)</a>
  <a href="#">MAC 853 - Concesso (em breve)</a>
  <a href="#">MAC 1249 - Jardim do Lago (em breve)</a>
  <a href="#">MAC AraÃºjos (em breve)</a>
</div>

<!-- Aviso cÃ³pia -->
<div id="copy-notice">Copiado!</div>

<script>
  // Dados originais da sua lista
  const frasesEsquerda = [
    "PÃƒO DE QUEIJO RECHEADO FRANGO  PAC7KG",
    "PÃƒO DE QUEIJO  7KG",
    "PÃƒO FRANCÃŠS 6HRS PAC 7KG",
    "PÃƒO DE 4 HRS  7KG",
    "BAGUETE 6  HRS  7KG",
    "BISCOITO DOCE FRITO MP 1 KG",
    "BISCOITO DE QUEIJO MP 7 KG",
    "BISCOITO SEQUILHO MP MANGA",
    "BISCOITO TRÃŠS QUEIJOS MP 7 KG",
    "BOLO FUBA CREMOSO MP 1 UNIDADE",
    "BOLO MILHO MP 1 UNIDADE",
    "BROINHA DE FUBA DOCE MP 7 KG",
    "BROINHA BACON TEMPERADA MP 7 KG",
    "CROISSANT DE FRANGO MP 7 KG",
    "CROISSANT DE PRESUNTO MP 7KG",
    "PÃƒO DE QUEIJO MEIA LUA MP PAC COM 10 UNI",
    "PÃƒO DOCE C/CREME MP 7KG",
    "PÃƒO DOCE MP 7KG",
    "PÃƒO PANHOCA MP 7KG",
    "ROSCOVADO MP UNIDADE",
    "ROSCA CREME E COCO MP PAC COM 5 UNI",
    "ROSCA TRANCA MP PAC COM 10 UNID",
    "ROSCA TRANCINHA MP PAC 3KG",
    "ROSCA TRANCA REDONDA MP",
    "ROSQUINHA CANUDINHO DE QUEIJO MP PAC COM 7KG",
    "SALGADO COXINHA DE FRANGO MP 1 KG",
    "SALGADOS BOLINHA DE CARNE MP 1KG",
    "SALGADOS EMPADA DE FRANGO MP 1 KG",
    "SALGADOS ENROLADINHO PRESUNTO MP 1 KG",
    "SALGADOS PASTEL CATUPIRY MP 1 KG",
    "SALGADOS KIBE CATUPIRY MP 1 KG",
    "SONHO MP PAC 3 KG"
  ];

  const frasesDireita = [
    "Baguete 06hrs 7kg",
    "Biscoitinho doce frito 1kg",
    "Biscoito de queijo 7kg",
    "Biscoito trÃªs queijos 7kg",
    "Bolinha de carne pequena 1kg",
    "Bolo cremoso de fubÃ¡ 1 unidade",
    "Bolo cremoso de milho 1 unidade",
    "Broinha de fubÃ¡ doce 7kg",
    "Broinha temperada com bacon 7kg",
    "Canudinho de queijo 7kg",
    "Caracol 7kg",
    "Carioca 7kg",
    "Coxinha de frango pequena 1kg",
    "Croissant de frango 7kg",
    "Croissant de presunto 7kg",
    "Empadinha de frango pequena 1kg",
    "Enroladinho de presunto pequeno 1kg",
    "Meia lua 1kg com 10 unidades",
    "Mistura biscoito sequilho 4kg",
    "Panhoca 7kg",
    "PÃ£o de queijo recheado frango 7kg",
    "PÃ£o de queijo tradicional 7kg",
    "PÃ£o francÃªs 04hrs 7kg",
    "PÃ£o francÃªs 06hrs 7kg",
    "Pastelzinho catupiry pequeno 1kg",
    "Quibe com catupiry pequeno 1kg",
    "Rosca creme e coco PCT 5 unidades",
    "Roscovado 1 unidade",
    "Sonho PCT 3kg",
    "TranÃ§a PCT 10 unidades",
    "Trancinha PCT 3kg",
    "Trancinha redonda"
  ];

  // Ãndices de conexÃ£o (origem -> destino)
  const mapaConexao = [5, 6, 7, 9, 27, 10, 11, 12, 13, 25, 17, 18, 26, 14, 15, 28, 29, 16, 8, 19, 1, 2, 4, 3, 30, 31, 21, 20, 32, 22, 23, 24];

  // Monta a interface: colunas esquerda e direita
  function montarInterface() {
    const colEsq = document.getElementById("coluna-esquerda");
    const colDir = document.getElementById("coluna-direita");
    colEsq.innerHTML = "";
    colDir.innerHTML = "";

    frasesEsquerda.forEach((frase, i) => {
      const item = document.createElement("div");
      item.className = "item";

      const label = document.createElement("span");
      label.textContent = frase;

      const input = document.createElement("input");
      input.type = "text";
      input.dataset.index = i;

      // Bloquear entrada que nÃ£o seja nÃºmero
      input.addEventListener("input", () => {
        input.value = input.value.replace(/[^0-9]/g, '');
      });
      // Enter pula para o prÃ³ximo input na esquerda
      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          e.preventDefault();
          const nextInput = colEsq.querySelector(`input[data-index="${i + 1}"]`);
          if (nextInput) nextInput.focus();
        }
      });

      item.appendChild(label);
      item.appendChild(input);
      colEsq.appendChild(item);
    });

    frasesDireita.forEach((frase, i) => {
      const item = document.createElement("div");
      item.className = "item";

      const label = document.createElement("span");
      label.textContent = frase;

      const output = document.createElement("input");
      output.type = "text";
      output.readOnly = true;
      output.dataset.index = i;

      item.appendChild(label);
      item.appendChild(output);
      colDir.appendChild(item);
    });
  }

  // Transfere valores da esquerda para a direita via mapaConexao
  function transferir() {
    const inputs = document.querySelectorAll("#coluna-esquerda input");
    const outputs = document.querySelectorAll("#coluna-direita input");
    mapaConexao.forEach((origem, destino) => {
      outputs[destino].value = inputs[origem - 1].value.trim();
    });
    atualizarContagemDireita();
  }

  // Controle para esconder/mostrar linhas vazias da direita
  let linhasOcultas = false;
  let elementosOcultos = [];

  function alternarLinhas() {
    if (!linhasOcultas) {
      removerVazios();
      document.getElementById('btn-linhas').innerText = "Restaurar Linhas Vazias";
    } else {
      restaurarLinhas();
      document.getElementById('btn-linhas').innerText = "Remover Linhas Vazias";
    }
    linhasOcultas = !linhasOcultas;
  }

  function removerVazios() {
    const inputs = document.querySelectorAll("#coluna-direita .item input");
    elementosOcultos = [];
    inputs.forEach(input => {
      if (input.value.trim() === "") {
        input.parentElement.style.display = "none";
        elementosOcultos.push(input.parentElement);
      }
    });
  }

  function restaurarLinhas() {
    elementosOcultos.forEach(el => el.style.display = "flex");
    elementosOcultos = [];
  }

  // Reseta todos os inputs e restaura linhas
  function resetarTudo() {
    const inputs = document.querySelectorAll("input[type='text']");
    inputs.forEach(input => input.value = "");
    restaurarLinhas();
    atualizarContagemDireita();
  }

  // Atualiza contador de linhas preenchidas na direita
  function atualizarContagemDireita() {
    const outputs = document.querySelectorAll("#coluna-direita input");
    let preenchidos = 0;
    outputs.forEach(output => {
      if (output.style.display !== "none" && output.value.trim() !== "") preenchidos++;
    });
    document.getElementById("contador-linhas").innerText = `Linhas preenchidas: ${preenchidos}`;
  }

  // Copiar conteÃºdo da coluna direita para Ã¡rea de transferÃªncia sem alert
  function copiarDireita() {
    const outputs = document.querySelectorAll("#coluna-direita input");
    const textos = [];
    outputs.forEach(output => {
      if (output.value.trim() !== "") {
        const label = output.parentElement.querySelector("span").textContent;
        textos.push(`${label}: ${output.value}`);
      }
    });
    const textoFinal = textos.join("\n");
    navigator.clipboard.writeText(textoFinal).then(() => {
      mostrarAvisoCopia();
    }).catch(() => {
      // falha silenciosa
    });
  }

  // Mostra mensagem de cÃ³pia por 2 segundos
  function mostrarAvisoCopia() {
    const aviso = document.getElementById("copy-notice");
    aviso.style.display = "block";
    setTimeout(() => { aviso.style.display = "none"; }, 2000);
  }

  // Salvar como TXT - pega tudo da coluna direita, label + valor
  function salvarComoTXT(e) {
    e.preventDefault();
    const outputs = document.querySelectorAll("#coluna-direita input");
    const textos = [];
    outputs.forEach(output => {
      if (output.value.trim() !== "") {
        const label = output.parentElement.querySelector("span").textContent;
        textos.push(`${label}: ${output.value}`);
      }
    });
    baixarArquivo(textos.join("\n"), "lista_mac_77.txt", "text/plain");
  }

  // Salvar como PDF - usa jsPDF, imprime as duas colunas e a contagem, texto simples
  function salvarComoPDF(e) {
    e.preventDefault();
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Pega os textos da esquerda e valores da direita via mapaConexao
    const linhas = [];
    mapaConexao.forEach((origem, destino) => {
      const texto = frasesEsquerda[origem-1];
      const valor = document.querySelectorAll("#coluna-direita input")[destino].value.trim();
      if(valor !== "") linhas.push({texto, valor});
    });

    doc.setFont("monospace");
    doc.setFontSize(12);

    let y = 10;
    linhas.forEach(({texto, valor}) => {
      doc.text(texto, 10, y);
      doc.text(valor, 120, y);
      y += 8;
    });
    doc.text(`Linhas preenchidas: ${linhas.length}`, 10, y + 10);

    doc.save("lista_mac_77.pdf");
  }

  // Salvar como Excel - usa SheetJS, sÃ³ coluna direita, frases + valores preenchidos
  function salvarComoExcel(e) {
    e.preventDefault();

    const wb = XLSX.utils.book_new();

    const data = [];
    const outputs = document.querySelectorAll("#coluna-direita input");
    outputs.forEach((output, i) => {
      if(output.value.trim() !== "") {
        data.push([frasesDireita[i], output.value]);
      }
    });

    const ws = XLSX.utils.aoa_to_sheet(data);
    XLSX.utils.book_append_sheet(wb, ws, "MAC 77");

    XLSX.writeFile(wb, "lista_mac_77.xlsx");
  }

  // Toggle menu dropdowns, fecha qualquer outro aberto
  function toggleMenu(id) {
    const allDropdowns = document.querySelectorAll(".menu-dropdown-content");
    allDropdowns.forEach(menu => {
      if(menu.id !== id) {
        menu.style.display = "none";
        menu.style.opacity = 0;
      }
    });
    const dropdown = document.getElementById(id);
    if(dropdown.style.display === "block") {
      dropdown.style.opacity = 0;
      setTimeout(() => { dropdown.style.display = "none"; }, 200);
    } else {
      dropdown.style.display = "block";
      setTimeout(() => { dropdown.style.opacity = 1; }, 10);
    }
  }

  // Fecha menus se clicar fora
  document.addEventListener("click", (e) => {
    if(!e.target.closest(".menu-dropdown")) {
      document.querySelectorAll(".menu-dropdown-content").forEach(menu => {
        menu.style.display = "none";
        menu.style.opacity = 0;
      });
    }
  });

  // FunÃ§Ã£o auxiliar para baixar arquivos
  function baixarArquivo(conteudo, nomeArquivo, tipo) {
    const blob = new Blob([conteudo], {type: tipo});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = nomeArquivo;
    a.click();
  }

  // Inicializa tudo ao carregar
  montarInterface();

</script>

</body>
</html>
