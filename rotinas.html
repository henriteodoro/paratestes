<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rotinas Diárias</title>
<meta name="description" content="Sistema organizado de rotinas diárias por semana" />
<style>
  :root{
    --azul:#007BFF;
    --accent:#0b5ed7;
    --fundo:#f7fbff;
    --card:#ffffff;
    --muted:#6b7280;
    --borda:#e6eefc;
    --borda-ativa:#cfe0ff;
    --ink:#0b3b6b;
    --ink-strong:#0b4fa0;
    --warn:#f59e0b;
    --success:#10b981;
    --danger:#ef4444;
    --verde-suave: #f0fff4;
    --verde-borda: #38a169;
    --roxo: #8a2be2;
    --laranja: #fb8c00;
    --teal: #00897b;
    --cinza-escuro: #5d4037;
  }
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, var(--fundo), #f3f7ff);
    min-height:100vh;
    margin:0;
    padding:18px;
    color:#111;
  }
  .wrap{max-width:1300px;margin:0 auto}
  h1{margin:0 0 8px 0;font-size:22px;color:var(--accent)}
  p.lead{margin:4px 0 16px 0;color:var(--muted);font-size:13px}

  .toolbar{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    background:var(--card);
    border:1px solid var(--borda);
    border-radius:12px;
    padding:12px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    position:sticky;
    top:14px;
    z-index:60;
    margin-bottom: 20px;
  }

  .btn-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 14px;
    border: 1px solid var(--borda);
    border-radius: 8px;
    background: var(--card);
    color: var(--ink);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 14px;
    font-weight: 500;
  }

  .btn-toolbar:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .btn-toolbar svg {
    width: 18px;
    height: 18px;
  }

  /* LAYOUT PRINCIPAL */
  .rotinas-container {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 20px;
    margin-top: 20px;
  }

  .dias-sidebar {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    height: fit-content;
    position: sticky;
    top: 90px;
  }

  .periodo-secao {
    margin-bottom: 24px;
  }

  .periodo-secao h3 {
    font-size: 14px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--borda);
  }

  .dia-item {
    padding: 12px 14px;
    border-radius: 10px;
    cursor: pointer;
    margin-bottom: 8px;
    transition: all 0.2s ease;
    font-weight: 600;
    font-size: 14px;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: 10px;
    border: 1px solid transparent;
    position: relative;
  }

  .dia-item:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .dia-item.ativo {
    background: var(--azul);
    color: white;
  }

  .dia-item svg {
    width: 18px;
    height: 18px;
  }

  .dia-item.hoje {
    background: #fff7f0;
    border-color: #fed7aa;
    color: #f59e0b;
  }

  .dia-item.feriado {
    background: #fff7f0;
    border-color: #fed7aa;
    color: #e67e22;
  }

  .dia-item.sem-expediente {
    background: #f8f9fa;
    color: var(--muted);
  }

  .checkbox-dia {
    position: absolute;
    right: 12px;
    width: 18px;
    height: 18px;
    cursor: pointer;
  }

  .conteudo-area {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    min-height: 400px;
    position: relative;
  }

  .conteudo-header {
    border-bottom: 1px solid var(--borda);
    padding-bottom: 16px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .conteudo-header h2 {
    margin: 0;
    font-size: 18px;
    color: var(--ink-strong);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .conteudo-header h2 svg {
    width: 20px;
    height: 20px;
  }

  .conteudo-header-acoes {
    display: flex;
    gap: 8px;
  }

  .btn-acao {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid var(--borda);
    background: var(--card);
    color: var(--ink);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 12px;
    font-weight: 500;
  }

  .btn-acao:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .btn-imprimir {
    background: #f0f9ff !important;
    border-color: #bae6fd !important;
    color: var(--azul) !important;
  }

  .btn-imprimir:hover {
    background: #e0f2fe !important;
  }

  /* LEGENDA */
  .legenda-container {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    margin-bottom: 20px;
  }

  .legenda-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    cursor: pointer;
    padding: 12px 16px;
    border-radius: 10px;
    background: #f8f9fa;
    border: 1px solid var(--borda);
    transition: all 0.2s ease;
  }

  .legenda-header:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .legenda-header h3 {
    margin: 0;
    font-size: 16px;
    color: var(--ink-strong);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .legenda-header h3 svg {
    width: 18px;
    height: 18px;
    transition: transform 0.3s ease;
  }

  .legenda-header.ativo h3 svg {
    transform: rotate(180deg);
  }

  .legenda-conteudo {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .legenda-conteudo.ativo {
    max-height: 500px;
    overflow-y: auto;
  }

  .legenda-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    padding: 16px 0;
  }

  .legenda-item {
    padding: 16px;
    border-radius: 10px;
    background: #f8f9fa;
    border: 1px solid var(--borda);
    transition: all 0.2s ease;
  }

  .legenda-item:hover {
    background: white;
    border-color: var(--borda-ativa);
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  .legenda-item-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .legenda-icone-grande {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .legenda-icone-grande svg {
    width: 18px;
    height: 18px;
    color: white;
  }

  .legenda-titulo {
    font-weight: 600;
    color: var(--ink-strong);
    font-size: 15px;
  }

  .legenda-desc {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.5;
  }

  .legenda-detalhes {
    margin-top: 12px;
    padding: 12px;
    background: white;
    border-radius: 8px;
    border-left: 4px solid var(--borda);
    font-size: 13px;
    color: var(--ink);
    line-height: 1.5;
  }

  .legenda-item.destaque {
    background: #f0f7ff;
    border-color: var(--azul);
    box-shadow: 0 4px 12px rgba(0,123,255,0.1);
  }

  /* TAREFAS DO DIA */
  .tarefas-dia {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 16px;
  }

  .tarefa-card {
    background: var(--fundo);
    border: 1px solid var(--borda);
    border-radius: 12px;
    padding: 18px;
    transition: all 0.2s ease;
    border-left: 4px solid var(--azul);
  }

  .tarefa-card:hover {
    border-color: var(--borda-ativa);
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    transform: translateY(-2px);
  }

  .tarefa-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
  }

  .tarefa-titulo {
    font-weight: 600;
    color: var(--ink-strong);
    font-size: 15px;
    line-height: 1.4;
    flex: 1;
  }

  .tarefa-icone {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
    flex-shrink: 0;
    margin-left: 12px;
  }

  .tarefa-icone:hover {
    transform: scale(1.1);
    border-color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .tarefa-icone svg {
    width: 16px;
    height: 16px;
    color: white;
  }

  .tarefa-desc {
    font-size: 14px;
    color: var(--ink);
    line-height: 1.5;
    margin-bottom: 12px;
  }

  .tarefa-pessoa {
    display: inline-block;
    background: #e3f2fd;
    color: var(--azul);
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    margin-top: 8px;
  }

  .sem-tarefas {
    text-align: center;
    padding: 60px 20px;
    color: var(--muted);
    grid-column: 1 / -1;
  }

  .sem-tarefas svg {
    width: 64px;
    height: 64px;
    opacity: 0.5;
    margin-bottom: 16px;
  }

  /* CATEGORIAS */
  .categoria-N1 { border-left-color: var(--danger); }
  .categoria-N2 { border-left-color: var(--azul); }
  .categoria-N3 { border-left-color: var(--cinza-escuro); }
  .categoria-N4 { border-left-color: var(--success); }
  .categoria-N5 { border-left-color: var(--laranja); }
  .categoria-N6 { border-left-color: var(--roxo); }
  .categoria-N7 { border-left-color: #5d4037; }
  .categoria-N8 { border-left-color: var(--teal); }
  .categoria-N9 { border-left-color: #f4511e; }
  .categoria-N10 { border-left-color: #00acc1; }

  .categoria-N1 .tarefa-icone { background: var(--danger); }
  .categoria-N2 .tarefa-icone { background: var(--azul); }
  .categoria-N3 .tarefa-icone { background: var(--cinza-escuro); }
  .categoria-N4 .tarefa-icone { background: var(--success); }
  .categoria-N5 .tarefa-icone { background: var(--laranja); }
  .categoria-N6 .tarefa-icone { background: var(--roxo); }
  .categoria-N7 .tarefa-icone { background: #5d4037; }
  .categoria-N8 .tarefa-icone { background: var(--teal); }
  .categoria-N9 .tarefa-icone { background: #f4511e; }
  .categoria-N10 .tarefa-icone { background: #00acc1; }

  .legenda-N1 .legenda-icone-grande { background: var(--danger); }
  .legenda-N2 .legenda-icone-grande { background: var(--azul); }
  .legenda-N3 .legenda-icone-grande { background: var(--cinza-escuro); }
  .legenda-N4 .legenda-icone-grande { background: var(--success); }
  .legenda-N5 .legenda-icone-grande { background: var(--laranja); }
  .legenda-N6 .legenda-icone-grande { background: var(--roxo); }
  .legenda-N7 .legenda-icone-grande { background: #5d4037; }
  .legenda-N8 .legenda-icone-grande { background: var(--teal); }
  .legenda-N9 .legenda-icone-grande { background: #f4511e; }
  .legenda-N10 .legenda-icone-grande { background: #00acc1; }

  /* INFO BOXES */
  .info-box {
    background: #f0f7ff;
    padding: 16px;
    border-radius: 10px;
    border-left: 4px solid var(--azul);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .info-box svg {
    width: 24px;
    height: 24px;
    color: var(--azul);
    flex-shrink: 0;
  }

  .info-box p {
    margin: 0;
    color: var(--ink);
    font-size: 14px;
    line-height: 1.5;
  }

  .feriado-box {
    background: #fff7f0;
    border-left-color: var(--warn);
  }

  .feriado-box svg {
    color: var(--warn);
  }

  /* SEARCH */
  .search {
    position: relative;
    flex: 1 1 200px;
  }

  .search input {
    width: 100%;
    padding: 12px 40px 12px 40px;
    border: 1px solid var(--borda);
    border-radius: 12px;
    background: #fbfdff;
    color: var(--ink);
    font-size: 14px;
  }

  .search svg {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 18px;
    height: 18px;
  }

  .resultados-busca {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 1px solid var(--borda);
    border-radius: 8px;
    margin-top: 4px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
    display: none;
  }

  .resultado-item {
    padding: 12px 16px;
    cursor: pointer;
    border-bottom: 1px solid var(--borda);
    transition: background 0.2s ease;
  }

  .resultado-item:hover {
    background: #f3f8ff;
  }

  .resultado-data {
    font-weight: 600;
    color: var(--ink-strong);
    margin-bottom: 4px;
  }

  .resultado-tarefa {
    font-size: 13px;
    color: var(--ink);
    margin-left: 8px;
  }

  /* ANIMAÇÕES */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .fade-in {
    animation: fadeIn 0.3s ease;
  }

  /* RESPONSIVO */
  @media (max-width: 768px) {
    .rotinas-container {
      grid-template-columns: 1fr;
    }
    .dias-sidebar {
      position: static;
      margin-bottom: 20px;
    }
    .tarefas-dia {
      grid-template-columns: 1fr;
    }
    .legenda-grid {
      grid-template-columns: 1fr;
    }
  }

  /* SCROLL TO TOP */
  .btn-voltar-topo {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: var(--azul);
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,123,255,0.3);
    transition: all 0.2s ease;
    z-index: 50;
    opacity: 0;
    visibility: hidden;
  }

  .btn-voltar-topo.visivel {
    opacity: 1;
    visibility: visible;
  }

  .btn-voltar-topo:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,123,255,0.4);
  }

  .btn-voltar-topo svg {
    width: 20px;
    height: 20px;
  }

  /* ESTILOS DE IMPRESSÃO */
  @media print {
    body {
      background: white !important;
      color: black !important;
      font-family: Arial, sans-serif !important;
      font-size: 12pt !important;
      line-height: 1.4 !important;
      margin: 0 !important;
      padding: 10mm !important;
    }
    
    .wrap {
      max-width: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
    }
    
    .toolbar,
    .legenda-container,
    .dias-sidebar,
    .conteudo-header-acoes,
    .btn-voltar-topo,
    .search,
    .btn-toolbar {
      display: none !important;
    }
    
    .rotinas-container {
      display: block !important;
      grid-template-columns: 1fr !important;
      gap: 0 !important;
      margin-top: 0 !important;
    }
    
    .conteudo-area {
      border: none !important;
      box-shadow: none !important;
      padding: 0 !important;
      margin: 0 !important;
      min-height: auto !important;
    }
    
    .conteudo-header {
      border-bottom: 2px solid #000 !important;
      padding-bottom: 10px !important;
      margin-bottom: 15px !important;
    }
    
    .conteudo-header h2 {
      font-size: 16pt !important;
      color: black !important;
    }
    
    .conteudo-header h2 svg {
      display: none !important;
    }
    
    .tarefas-dia {
      grid-template-columns: 1fr !important;
      gap: 10px !important;
    }
    
    .tarefa-card {
      page-break-inside: avoid !important;
      border: 1px solid #ddd !important;
      border-left: 4px solid #000 !important;
      margin-bottom: 10px !important;
      padding: 10px !important;
    }
    
    .tarefa-titulo {
      font-size: 12pt !important;
      color: black !important;
    }
    
    .tarefa-desc {
      font-size: 11pt !important;
    }
    
    .tarefa-icone {
      display: none !important;
    }
    
    .tarefa-pessoa {
      background: none !important;
      color: black !important;
      border: 1px solid #ccc !important;
      padding: 2px 6px !important;
    }
    
    h1 {
      font-size: 18pt !important;
      margin-bottom: 5px !important;
    }
    
    p.lead {
      font-size: 11pt !important;
      margin-bottom: 15px !important;
    }
    
    /* Estilos para impressão de tudo/selecionados */
    .impressao-tabela {
      width: 100% !important;
      border-collapse: collapse !important;
      margin: 15px 0 !important;
      font-size: 11pt !important;
    }
    
    .impressao-tabela th,
    .impressao-tabela td {
      border: 1px solid #000 !important;
      padding: 8px !important;
      text-align: left !important;
      vertical-align: top !important;
    }
    
    .impressao-tabela th {
      background-color: #f0f0f0 !important;
      font-weight: bold !important;
    }
    
    .impressao-tabela tr {
      page-break-inside: avoid !important;
    }
    
    .impressao-titulo {
      font-size: 16pt !important;
      font-weight: bold !important;
      margin: 10px 0 !important;
      text-align: center !important;
    }
    
    .impressao-data {
      font-size: 12pt !important;
      margin-bottom: 20px !important;
      text-align: center !important;
    }
    
    .impressao-legenda {
      margin-top: 25px !important;
      padding: 15px !important;
      border: 1px solid #000 !important;
      page-break-inside: avoid !important;
    }
    
    .impressao-legenda h3 {
      margin-top: 0 !important;
      font-size: 13pt !important;
    }
    
    .impressao-legenda-item {
      margin-bottom: 8px !important;
      padding: 5px !important;
      border-left: 3px solid #000 !important;
      font-size: 10pt !important;
    }
    
    @page {
      margin: 15mm !important;
      size: A4 !important;
    }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Rotinas Diárias</h1>
    <p class="lead">Sistema organizado de rotinas por dia da semana - Dezembro 2025 a Janeiro 2026</p>
  </header>

  <div class="toolbar">
    <div class="search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg>
      <input type="search" id="campo-busca" placeholder="Buscar nas rotinas..." />
      <div class="resultados-busca" id="resultados-busca"></div>
    </div>
    <button class="btn-toolbar" id="btn-imprimir-tudo">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
        <rect x="6" y="14" width="12" height="8"/>
      </svg>
      Imprimir Tudo
    </button>
    <button class="btn-toolbar" id="btn-imprimir-selecionados">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
        <rect x="6" y="14" width="12" height="8"/>
      </svg>
      Imprimir Selecionados
    </button>
  </div>

  <div class="legenda-container">
    <div class="legenda-header" id="legenda-toggle">
      <h3>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        Legenda das Categorias
      </h3>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
        <polyline points="6 9 12 15 18 9"/>
      </svg>
    </div>
    
    <div class="legenda-conteudo" id="legenda-conteudo">
      <div class="legenda-grid" id="legenda-grid">
        <!-- A legenda será carregada aqui -->
      </div>
    </div>
  </div>

  <div class="rotinas-container">
    <div class="dias-sidebar">
      <!-- Dias serão carregados dinamicamente -->
    </div>

    <div class="conteudo-area">
      <div class="conteudo-header">
        <h2 id="dia-titulo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          Selecione um dia
        </h2>
        <div class="conteudo-header-acoes">
          <button class="btn-acao btn-imprimir" id="btn-imprimir-dia">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
              <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
              <rect x="6" y="14" width="12" height="8"/>
            </svg>
            Imprimir Dia
          </button>
        </div>
      </div>

      <div id="conteudo-dinamico">
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Selecione um dia na barra lateral para visualizar as rotinas</p>
        </div>
      </div>
    </div>
  </div>
</div>

<button class="btn-voltar-topo" id="btn-voltar-topo">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polyline points="18 15 12 9 6 15"/>
  </svg>
</button>

<script>
// Dados das categorias (N1, N2, etc.)
const categorias = {
  "N1": {
    nome: "Cobranças WhatsApp",
    descricao: "Fazer cobranças no WhatsApp dos clientes",
    detalhes: "Para fazer as cobranças, tire o relatório de cobranças (ver site anotações) e no WhatsApp, procure pelo cliente e mande a mensagem pronta de cobranças dos boletos. Caso tenha algum cliente que está devendo boleto a um tempo e que não foi a protesto ainda, cobrar comprovante também.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"/></svg>`,
    cor: "#ef4444"
  },
  "N2": {
    nome: "Pedidos Clientes",
    descricao: "Mandar mensagem para clientes pedindo pedido",
    detalhes: "Na web do sistema, vá em telemarketing, olhe os clientes que ainda não tiveram pedidos gerados e peça pedindo para mandarem os pedidos. Horário: 9:00-9:30.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>`,
    cor: "#007BFF"
  },
  "N3": {
    nome: "Pedir Café",
    descricao: "Pedir café para produção caso precise",
    detalhes: "Confirmar na produção, geralmente na embalagem ou no setor do Ceará se precisa de café caso fiquem até mais tarde.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>`,
    cor: "#5d4037"
  },
  "N4": {
    nome: "Montagem Rotas",
    descricao: "Montagem das rotas de entrega",
    detalhes: "Confira a seção de montagem rotas nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>`,
    cor: "#10b981"
  },
  "N5": {
    nome: "Lista Embalagem",
    descricao: "Pegar lista da embalagem São José e Pão Total",
    detalhes: "Pegar ou pedir para trazerem a lista no escritório. Caso eles tenham perdido ou esquecido de levar, perguntar ao Guilherme ou ao Kauan o que faltou para deixar anotado.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
    cor: "#fb8c00"
  },
  "N6": {
    nome: "Fechamento Caixas",
    descricao: "Fechamento de caixas (Barão)",
    detalhes: "Confira a seção de fechamento caixas nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M16 10v4"/><path d="M8 10v4"/><path d="M12 10v4"/><path d="M2 10h20"/></svg>`,
    cor: "#8a2be2"
  },
  "N7": {
    nome: "Café Sábado",
    descricao: "Pedir café para sábado caso precise",
    detalhes: "Caso tenha produção sábado, tem que pedir na padaria café para a quantidade de pessoas que virão e pedir para entregar na fábrica. Mas caso não der, tem que pedir para alguém buscar.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>`,
    cor: "#5d4037"
  },
  "N8": {
    nome: "Acerto Célio",
    descricao: "Acerto com o fornecedor Célio",
    detalhes: "Confira o tópico Célio (pagamentos e pix) na seção fornecedores nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>`,
    cor: "#00897b"
  },
  "N9": {
    nome: "Lista São José",
    descricao: "Fazer lista da São José e Pão Total",
    detalhes: "Confira o tópico São José na seção geral nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
    cor: "#f4511e"
  },
  "N10": {
    nome: "Adiantamento Salarial",
    descricao: "Adiantamento salarial no banco",
    detalhes: "No banco vá em folha de pagamento, clique em cadastrar, coloque a data e selecione os funcionários. Escreva os valores e confirme. Depois no aplicativo do banco, vá na opção de 2 fatores e na web, procure o adiantamento que acabou de fazer e clique em processar. Escaneie o QR code, confirme no celular e depois na web coloque o código que aparece no celular. Confirmar e pronto.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M16 10v4"/><path d="M8 10v4"/><path d="M12 10v4"/><path d="M2 10h20"/></svg>`,
    cor: "#00acc1"
  },
  "N11": {
    nome: "Cheques Início do Mês",
    descricao: "Fazer cheques do início do mês",
    detalhes: "Confira o tópico Cheques Início e Final de Mês na seção geral nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M16 10v4"/><path d="M8 10v4"/><path d="M12 10v4"/><path d="M2 10h20"/></svg>`,
    cor: "#00acc1"
  }
};

// Dados das rotinas por data
const rotinas = {
  "31/12/2025": {
    data: "31/12/2025",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "01/01/2026": {
    data: "01/01/2026",
    diaSemana: "Quinta-feira",
    feriado: true,
    feriadoNome: "Ano Novo",
    semExpediente: true,
    tarefas: []
  },
  "02/01/2026": {
    data: "02/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: true,
    tarefas: []
  },
  "05/01/2026": {
    data: "05/01/2026",
    diaSemana: "Segunda-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Entregar a embalagem",
        pessoa: "Emillie"
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Fazer cheques do início do mês",
        categoria: "N11",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Entregar planilhas de autocontrole",
        categoria: null,
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "06/01/2026": {
    data: "06/01/2026",
    diaSemana: "Terça-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "07/01/2026": {
    data: "07/01/2026",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "08/01/2026": {
    data: "08/01/2026",
    diaSemana: "Quinta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Deixar junto com os romaneios",
        pessoa: "Emillie"
      }
    ]
  },
  "09/01/2026": {
    data: "09/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "Até 11:00 ou 12:00",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Pedir café para sábado caso precise",
        categoria: "N7",
        descricao: "",
        pessoa: "Adeilton e Luiz Felipe"
      },
      {
        titulo: "Separar dinheiro caso tenha produção sábado",
        categoria: null,
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Acerto Célio",
        categoria: "N8",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "12/01/2026": {
    data: "12/01/2026",
    diaSemana: "Segunda-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Entregar a embalagem",
        pessoa: "Emillie"
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "13/01/2026": {
    data: "13/01/2026",
    diaSemana: "Terça-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Retorno Marina",
        categoria: null,
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "14/01/2026": {
    data: "14/01/2026",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "15/01/2026": {
    data: "15/01/2026",
    diaSemana: "Quinta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Adiantamento salarial no banco",
        categoria: "N10",
        descricao: "",
        pessoa: "Marina"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Deixar junto com os romaneios",
        pessoa: "Emillie"
      }
    ]
  },
  "16/01/2026": {
    data: "16/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "Até 11:00 ou 12:00",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: "Luiz Felipe"
      },
      {
        titulo: "Pedir café para sábado caso precise",
        categoria: "N7",
        descricao: "",
        pessoa: "Adeilton e Luiz Felipe"
      },
      {
        titulo: "Separar dinheiro caso tenha produção sábado",
        categoria: null,
        descricao: "",
        pessoa: "Marina ou Barão"
      },
      {
        titulo: "Acerto Célio",
        categoria: "N8",
        descricao: "",
        pessoa: "Marina ou Barão"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  }
};

// Sistema principal
class SistemaRotinas {
  constructor() {
    this.diaAtual = null;
    this.termoBusca = "";
    this.buscaAtiva = false;
    this.legendaAberta = false;
    this.diasSelecionados = new Set();
    
    this.init();
  }
  
  init() {
    this.carregarLegenda();
    this.carregarSidebar();
    this.configurarEventos();
    this.verificarHoje();
  }
  
  carregarLegenda() {
    const grid = document.getElementById("legenda-grid");
    let html = "";
    
    Object.entries(categorias).forEach(([codigo, categoria]) => {
      html += `
        <div class="legenda-item legenda-${codigo}" id="legenda-${codigo}">
          <div class="legenda-item-header">
            <div class="legenda-icone-grande">
              ${categoria.icone}
            </div>
            <div>
              <div class="legenda-titulo">${codigo}: ${categoria.nome}</div>
              <div class="legenda-desc">${categoria.descricao}</div>
            </div>
          </div>
          <div class="legenda-detalhes">
            ${categoria.detalhes}
          </div>
        </div>
      `;
    });
    
    grid.innerHTML = html;
  }
  
  carregarSidebar() {
    const sidebar = document.querySelector(".dias-sidebar");
    const semanas = this.agruparPorSemanas();
    
    let html = "";
    
    semanas.forEach((semana, index) => {
      html += `<div class="periodo-secao">`;
      html += `<h3>${semana.titulo}</h3>`;
      
      semana.dias.forEach(data => {
        const dia = rotinas[data];
        if (!dia) return;
        
        let classeExtra = "";
        if (dia.feriado) classeExtra = "feriado";
        if (dia.semExpediente && !dia.feriado) classeExtra = "sem-expediente";
        
        html += `
          <div class="dia-item ${classeExtra}" data-data="${data}">
            <input type="checkbox" class="checkbox-dia" data-data="${data}">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
              <path d="M8 2v4M16 2v4M2 10h20"/>
            </svg>
            ${data.split('/')[0]}/${data.split('/')[1]} - ${dia.diaSemana}
          </div>
        `;
      });
      
      html += `</div>`;
    });
    
    sidebar.innerHTML = html;
  }
  
  configurarEventos() {
    // Dias da sidebar
    document.addEventListener("click", (e) => {
      const diaItem = e.target.closest(".dia-item");
      if (diaItem && !e.target.classList.contains("checkbox-dia")) {
        const data = diaItem.getAttribute("data-data");
        this.carregarDia(data);
      }
    });
    
    // Checkboxes
    document.addEventListener("change", (e) => {
      if (e.target.classList.contains("checkbox-dia")) {
        const data = e.target.getAttribute("data-data");
        if (e.target.checked) {
          this.diasSelecionados.add(data);
        } else {
          this.diasSelecionados.delete(data);
        }
      }
    });
    
    // Toggle legenda
    document.getElementById("legenda-toggle").addEventListener("click", () => {
      this.toggleLegenda();
    });
    
    // Busca
    document.getElementById("campo-busca").addEventListener("input", (e) => {
      this.realizarBuscaGlobal(e.target.value);
    });
    
    // Fechar resultados ao clicar fora
    document.addEventListener("click", (e) => {
      if (!e.target.closest(".search")) {
        const resultados = document.getElementById("resultados-busca");
        if (resultados) resultados.style.display = "none";
      }
    });
    
    // Botão voltar ao topo
    const btnTopo = document.getElementById("btn-voltar-topo");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 300) {
        btnTopo.classList.add("visivel");
      } else {
        btnTopo.classList.remove("visivel");
      }
    });
    
    btnTopo.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
    
    // Sistema de impressão
    document.getElementById("btn-imprimir-dia").addEventListener("click", () => {
      this.imprimirDia();
    });
    
    document.getElementById("btn-imprimir-tudo").addEventListener("click", () => {
      this.imprimirTudo();
    });
    
    document.getElementById("btn-imprimir-selecionados").addEventListener("click", () => {
      this.imprimirSelecionados();
    });
  }
  
  carregarDia(data) {
    this.diaAtual = data;
    const dia = rotinas[data];
    
    if (!dia) return;
    
    // Atualizar seleção na sidebar
    document.querySelectorAll(".dia-item").forEach(item => {
      item.classList.remove("ativo");
    });
    
    document.querySelector(`.dia-item[data-data="${data}"]`).classList.add("ativo");
    
    // Atualizar título
    document.getElementById("dia-titulo").innerHTML = `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
      </svg>
      ${dia.data} - ${dia.diaSemana}
      ${dia.feriado ? `<span style="color: var(--warn); font-size: 14px;"> (${dia.feriadoNome})</span>` : ""}
      ${dia.semExpediente && !dia.feriado ? `<span style="color: var(--muted); font-size: 14px;"> (Sem expediente)</span>` : ""}
    `;
    
    // Renderizar conteúdo
    this.renderizarDia(dia);
  }
  
  renderizarDia(dia) {
    const container = document.getElementById("conteudo-dinamico");
    
    if (dia.semExpediente) {
      container.innerHTML = `
        <div class="info-box feriado-box">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>${dia.feriado ? dia.feriadoNome : "Sem expediente"} - Nenhuma tarefa agendada para este dia.</p>
        </div>
      `;
      return;
    }
    
    if (!dia.tarefas || dia.tarefas.length === 0) {
      container.innerHTML = `
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Nenhuma tarefa agendada para este dia</p>
        </div>
      `;
      return;
    }
    
    // Filtrar tarefas se houver busca
    let tarefas = dia.tarefas;
    if (this.buscaAtiva && this.termoBusca) {
      const termo = this.termoBusca.toLowerCase();
      tarefas = dia.tarefas.filter(tarefa => 
        tarefa.titulo.toLowerCase().includes(termo) ||
        (tarefa.pessoa && tarefa.pessoa.toLowerCase().includes(termo)) ||
        (tarefa.categoria && categorias[tarefa.categoria]?.nome.toLowerCase().includes(termo)) ||
        (tarefa.categoria && categorias[tarefa.categoria]?.descricao.toLowerCase().includes(termo))
      );
    }
    
    if (tarefas.length === 0) {
      container.innerHTML = `
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Nenhuma tarefa encontrada com o termo "${this.termoBusca}"</p>
        </div>
      `;
      return;
    }
    
    // Renderizar tarefas
    let html = `<div class="tarefas-dia">`;
    
    tarefas.forEach((tarefa, index) => {
      const categoria = tarefa.categoria ? categorias[tarefa.categoria] : null;
      const classeCategoria = tarefa.categoria ? ` categoria-${tarefa.categoria}` : "";
      
      html += `
        <div class="tarefa-card fade-in${classeCategoria}" style="animation-delay: ${index * 0.05}s">
          <div class="tarefa-header">
            <div class="tarefa-titulo">${tarefa.titulo}</div>
            ${tarefa.categoria ? `
              <div class="tarefa-icone" data-categoria="${tarefa.categoria}" title="Clique para ver detalhes da categoria">
                ${categoria.icone}
              </div>
            ` : ""}
          </div>
          ${tarefa.descricao ? `<div class="tarefa-desc">${tarefa.descricao}</div>` : ""}
          ${tarefa.pessoa ? `<div class="tarefa-pessoa">${tarefa.pessoa}</div>` : ""}
        </div>
      `;
    });
    
    html += `</div>`;
    container.innerHTML = html;
    
    // Adicionar eventos aos ícones
    document.querySelectorAll(".tarefa-icone").forEach(icone => {
      icone.addEventListener("click", (e) => {
        e.stopPropagation();
        const categoria = icone.getAttribute("data-categoria");
        this.mostrarCategoria(categoria);
      });
    });
  }
  
  realizarBuscaGlobal(termo) {
    const resultadosContainer = document.getElementById("resultados-busca");
    
    if (!termo.trim()) {
      resultadosContainer.style.display = "none";
      return;
    }
    
    this.termoBusca = termo;
    let resultadosHTML = "";
    let encontrouResultados = false;
    
    // Buscar em todos os dias
    Object.entries(rotinas).forEach(([data, dia]) => {
      const tarefasEncontradas = dia.tarefas.filter(tarefa => 
        tarefa.titulo.toLowerCase().includes(termo.toLowerCase()) ||
        (tarefa.pessoa && tarefa.pessoa.toLowerCase().includes(termo.toLowerCase())) ||
        (tarefa.categoria && categorias[tarefa.categoria]?.nome.toLowerCase().includes(termo.toLowerCase())) ||
        (tarefa.categoria && categorias[tarefa.categoria]?.descricao.toLowerCase().includes(termo.toLowerCase()))
      );
      
      if (tarefasEncontradas.length > 0) {
        encontrouResultados = true;
        resultadosHTML += `<div class="resultado-item" data-data="${data}">`;
        resultadosHTML += `<div class="resultado-data">${dia.data} - ${dia.diaSemana}</div>`;
        tarefasEncontradas.forEach(tarefa => {
          resultadosHTML += `<div class="resultado-tarefa">${tarefa.titulo}</div>`;
        });
        resultadosHTML += `</div>`;
      }
    });
    
    if (encontrouResultados) {
      resultadosContainer.innerHTML = resultadosHTML;
      resultadosContainer.style.display = "block";
      
      // Adicionar evento de clique para cada resultado
      document.querySelectorAll(".resultado-item").forEach(item => {
        item.addEventListener("click", () => {
          const data = item.getAttribute("data-data");
          this.carregarDia(data);
          resultadosContainer.style.display = "none";
          document.getElementById("campo-busca").value = "";
        });
      });
    } else {
      resultadosContainer.innerHTML = '<div class="resultado-item">Nenhum resultado encontrado.</div>';
      resultadosContainer.style.display = "block";
    }
  }
  
  mostrarCategoria(codigo) {
    // Subir a página até o topo
    window.scrollTo({ top: 0, behavior: "smooth" });
    
    // Abrir legenda se estiver fechada
    if (!this.legendaAberta) {
      this.toggleLegenda(true);
    }
    
    // Aguardar a abertura da legenda e rolar até o item
    setTimeout(() => {
      const item = document.getElementById(`legenda-${codigo}`);
      const conteudoLegenda = document.getElementById("legenda-conteudo");
      
      if (item && conteudoLegenda) {
        // Rolar o container da legenda até o item
        const offsetTop = item.offsetTop - conteudoLegenda.offsetTop;
        conteudoLegenda.scrollTop = offsetTop - 20;
        
        // Destacar o item
        this.destacarLegendaItem(codigo);
      }
    }, 100);
  }
  
  destacarLegendaItem(codigo) {
    // Remover destaque anterior
    document.querySelectorAll(".legenda-item").forEach(item => {
      item.classList.remove("destaque");
    });
    
    // Destacar novo item
    const item = document.getElementById(`legenda-${codigo}`);
    if (item) {
      item.classList.add("destaque");
      
      // Remover destaque após 3 segundos
      setTimeout(() => {
        item.classList.remove("destaque");
      }, 3000);
    }
  }
  
  toggleLegenda(forcarAbrir = false) {
    const conteudo = document.getElementById("legenda-conteudo");
    const toggle = document.getElementById("legenda-toggle");
    
    if (forcarAbrir && !this.legendaAberta) {
      conteudo.classList.add("ativo");
      toggle.classList.add("ativo");
      this.legendaAberta = true;
    } else {
      conteudo.classList.toggle("ativo");
      toggle.classList.toggle("ativo");
      this.legendaAberta = conteudo.classList.contains("ativo");
    }
  }
  
  verificarHoje() {
    const hoje = new Date();
    const hojeFormatado = hoje.toLocaleDateString('pt-BR', {
      day: '2-digit',
      month: '2-digit',
      year: 'numeric'
    });
    
    // Verificar se hoje está nos dados
    if (rotinas[hojeFormatado]) {
      setTimeout(() => {
        this.carregarDia(hojeFormatado);
        
        // Destacar item na sidebar
        const itemHoje = document.querySelector(`.dia-item[data-data="${hojeFormatado}"]`);
        if (itemHoje) {
          itemHoje.classList.add("hoje");
        }
      }, 500);
    }
  }
  
  agruparPorSemanas() {
    const semanas = [
      {
        titulo: "31/12/2025 - 02/01/2026",
        dias: ["31/12/2025", "01/01/2026", "02/01/2026"]
      },
      {
        titulo: "05/01/2026 - 09/01/2026",
        dias: ["05/01/2026", "06/01/2026", "07/01/2026", "08/01/2026", "09/01/2026"]
      },
      {
        titulo: "12/01/2026 - 16/01/2026",
        dias: ["12/01/2026", "13/01/2026", "14/01/2026", "15/01/2026", "16/01/2026"]
      }
    ];
    
    return semanas;
  }
  
  // ========== SISTEMA DE IMPRESSÃO SIMPLIFICADO ==========
  
  imprimirDia() {
    if (!this.diaAtual) {
      alert("Selecione um dia para imprimir.");
      return;
    }
    
    // Simplesmente chama a impressão do navegador
    window.print();
  }
  
  imprimirTudo() {
    // Salvar o conteúdo atual
    const conteudoOriginal = document.getElementById('conteudo-dinamico').innerHTML;
    const tituloOriginal = document.getElementById('dia-titulo').innerHTML;
    
    // Gerar conteúdo para impressão
    let html = `
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 24px; margin-bottom: 10px;">Rotinas Completas</h1>
        <div style="font-size: 16px; color: #666; margin-bottom: 20px;">Dezembro 2025 a Janeiro 2026</div>
      </div>
    `;
    
    const semanas = this.agruparPorSemanas();
    
    semanas.forEach((semana, semanaIndex) => {
      html += `<h2 style="font-size: 18px; margin-top: 30px; margin-bottom: 15px;">${semana.titulo}</h2>`;
      
      semana.dias.forEach(data => {
        const dia = rotinas[data];
        if (!dia) return;
        
        html += `
          <div style="border: 1px solid #ddd; margin-bottom: 15px; padding: 15px; page-break-inside: avoid;">
            <div style="font-weight: bold; font-size: 16px; margin-bottom: 10px;">
              ${dia.data} - ${dia.diaSemana}
              ${dia.feriado ? ` (${dia.feriadoNome})` : ''}
              ${dia.semExpediente && !dia.feriado ? ' (Sem expediente)' : ''}
            </div>
        `;
        
        if (dia.semExpediente) {
          html += `<div style="font-style: italic; color: #666;">${dia.feriado ? dia.feriadoNome : 'Sem expediente'}</div>`;
        } else if (dia.tarefas.length > 0) {
          html += `<div style="padding-left: 10px;">`;
          dia.tarefas.forEach((tarefa, index) => {
            html += `
              <div style="margin-bottom: 8px; padding-left: 0;">
                <div style="font-weight: bold;">${tarefa.titulo}</div>
                ${tarefa.descricao ? `<div style="margin-left: 10px;">${tarefa.descricao}</div>` : ''}
                ${tarefa.pessoa ? `<div style="margin-left: 10px; font-style: italic;">Responsável: ${tarefa.pessoa}</div>` : ''}
                ${tarefa.categoria ? `<div style="margin-left: 10px; font-size: 12px;">Categoria: ${tarefa.categoria}</div>` : ''}
              </div>
            `;
          });
          html += `</div>`;
        } else {
          html += `<div style="font-style: italic; color: #666;">Nenhuma tarefa agendada</div>`;
        }
        
        html += `</div>`;
      });
    });
    
    // Adicionar legenda
    const categoriasUsadas = this.obterCategoriasDeTodasTarefas();
    if (categoriasUsadas.length > 0) {
      html += `
        <div style="border: 1px solid #000; margin-top: 30px; padding: 15px; page-break-inside: avoid;">
          <h3 style="font-size: 16px; margin-top: 0;">Legenda das Categorias</h3>
      `;
      
      categoriasUsadas.forEach(cat => {
        const categoriaInfo = categorias[cat.codigo];
        if (categoriaInfo) {
          html += `
            <div style="margin-bottom: 8px; padding: 8px; border-left: 3px solid ${categoriaInfo.cor};">
              <strong>${cat.codigo}:</strong> ${cat.nome} - ${cat.descricao}
            </div>
          `;
        }
      });
      
      html += `</div>`;
    }
    
    // Substituir conteúdo temporariamente
    document.getElementById('conteudo-dinamico').innerHTML = html;
    document.getElementById('dia-titulo').innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>Impressão de Todas as Rotinas';
    
    // Chamar impressão
    setTimeout(() => {
      window.print();
      
      // Restaurar conteúdo após impressão
      setTimeout(() => {
        document.getElementById('conteudo-dinamico').innerHTML = conteudoOriginal;
        document.getElementById('dia-titulo').innerHTML = tituloOriginal;
        
        // Se havia um dia selecionado, recarregar
        if (this.diaAtual) {
          this.carregarDia(this.diaAtual);
        }
      }, 100);
    }, 100);
  }
  
  imprimirSelecionados() {
    if (this.diasSelecionados.size === 0) {
      alert("Selecione pelo menos um dia para imprimir.");
      return;
    }
    
    // Salvar o conteúdo atual
    const conteudoOriginal = document.getElementById('conteudo-dinamico').innerHTML;
    const tituloOriginal = document.getElementById('dia-titulo').innerHTML;
    
    // Gerar conteúdo para impressão
    let html = `
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 24px; margin-bottom: 10px;">Rotinas Selecionadas</h1>
        <div style="font-size: 16px; color: #666; margin-bottom: 20px;">${this.diasSelecionados.size} dia(s) selecionado(s)</div>
      </div>
    `;
    
    const diasArray = Array.from(this.diasSelecionados).sort();
    
    diasArray.forEach(data => {
      const dia = rotinas[data];
      if (!dia) return;
      
      html += `
        <div style="border: 1px solid #ddd; margin-bottom: 20px; padding: 15px; page-break-inside: avoid;">
          <div style="font-weight: bold; font-size: 16px; margin-bottom: 10px;">
            ${dia.data} - ${dia.diaSemana}
            ${dia.feriado ? ` (${dia.feriadoNome})` : ''}
            ${dia.semExpediente && !dia.feriado ? ' (Sem expediente)' : ''}
          </div>
      `;
      
      if (dia.semExpediente) {
        html += `<div style="font-style: italic; color: #666;">${dia.feriado ? dia.feriadoNome : 'Sem expediente'}</div>`;
      } else if (dia.tarefas.length > 0) {
        html += `<div style="padding-left: 10px;">`;
        dia.tarefas.forEach(tarefa => {
          html += `
            <div style="margin-bottom: 8px; padding-left: 0;">
              <div style="font-weight: bold;">${tarefa.titulo}</div>
              ${tarefa.descricao ? `<div style="margin-left: 10px;">${tarefa.descricao}</div>` : ''}
              ${tarefa.pessoa ? `<div style="margin-left: 10px; font-style: italic;">Responsável: ${tarefa.pessoa}</div>` : ''}
              ${tarefa.categoria ? `<div style="margin-left: 10px; font-size: 12px;">Categoria: ${tarefa.categoria}</div>` : ''}
            </div>
          `;
        });
        html += `</div>`;
      } else {
        html += `<div style="font-style: italic; color: #666;">Nenhuma tarefa agendada</div>`;
      }
      
      html += `</div>`;
    });
    
    // Adicionar legenda
    const categoriasUsadas = this.obterCategoriasDeDiasSelecionados(diasArray);
    if (categoriasUsadas.length > 0) {
      html += `
        <div style="border: 1px solid #000; margin-top: 30px; padding: 15px; page-break-inside: avoid;">
          <h3 style="font-size: 16px; margin-top: 0;">Legenda das Categorias</h3>
      `;
      
      categoriasUsadas.forEach(cat => {
        const categoriaInfo = categorias[cat.codigo];
        if (categoriaInfo) {
          html += `
            <div style="margin-bottom: 8px; padding: 8px; border-left: 3px solid ${categoriaInfo.cor};">
              <strong>${cat.codigo}:</strong> ${cat.nome} - ${cat.descricao}
            </div>
          `;
        }
      });
      
      html += `</div>`;
    }
    
    // Substituir conteúdo temporariamente
    document.getElementById('conteudo-dinamico').innerHTML = html;
    document.getElementById('dia-titulo').innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>Impressão de Dias Selecionados';
    
    // Chamar impressão
    setTimeout(() => {
      window.print();
      
      // Restaurar conteúdo após impressão
      setTimeout(() => {
        document.getElementById('conteudo-dinamico').innerHTML = conteudoOriginal;
        document.getElementById('dia-titulo').innerHTML = tituloOriginal;
        
        // Se havia um dia selecionado, recarregar
        if (this.diaAtual) {
          this.carregarDia(this.diaAtual);
        }
      }, 100);
    }, 100);
  }
  
  obterCategoriasDeTodasTarefas() {
    const categoriasSet = new Set();
    Object.values(rotinas).forEach(dia => {
      dia.tarefas.forEach(tarefa => {
        if (tarefa.categoria && categorias[tarefa.categoria]) {
          categoriasSet.add(tarefa.categoria);
        }
      });
    });
    
    return Array.from(categoriasSet).map(codigo => ({
      codigo,
      nome: categorias[codigo].nome,
      descricao: categorias[codigo].descricao
    }));
  }
  
  obterCategoriasDeDiasSelecionados(diasArray) {
    const categoriasSet = new Set();
    diasArray.forEach(data => {
      const dia = rotinas[data];
      if (dia) {
        dia.tarefas.forEach(tarefa => {
          if (tarefa.categoria && categorias[tarefa.categoria]) {
            categoriasSet.add(tarefa.categoria);
          }
        });
      }
    });
    
    return Array.from(categoriasSet).map(codigo => ({
      codigo,
      nome: categorias[codigo].nome,
      descricao: categorias[codigo].descricao
    }));
  }
}

// Inicializar quando o DOM estiver pronto
document.addEventListener("DOMContentLoaded", () => {
  new SistemaRotinas();
});
</script>
</body>
</html>
