<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rotinas Diárias — MACs & Guias</title>
<meta name="description" content="Sistema organizado de rotinas diárias por semana" />
<style>
  :root{
    --azul:#007BFF;
    --accent:#0b5ed7;
    --fundo:#f7fbff;
    --card:#ffffff;
    --muted:#6b7280;
    --borda:#e6eefc;
    --borda-ativa:#cfe0ff;
    --ink:#0b3b6b;
    --ink-strong:#0b4fa0;
    --warn:#f59e0b;
    --success:#10b981;
    --danger:#ef4444;
    --verde-suave: #f0fff4;
    --verde-borda: #38a169;
    --roxo: #8a2be2;
    --laranja: #fb8c00;
    --teal: #00897b;
    --cinza-escuro: #5d4037;
  }
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, var(--fundo), #f3f7ff);
    min-height:100vh;
    margin:0;
    padding:18px;
    color:#111;
  }
  .wrap{max-width:1300px;margin:0 auto}
  h1{margin:0 0 8px 0;font-size:22px;color:var(--accent)}
  p.lead{margin:4px 0 16px 0;color:var(--muted);font-size:13px}

  .toolbar{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
    background:var(--card);
    border:1px solid var(--borda);
    border-radius:12px;
    padding:12px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    position:sticky;
    top:14px;
    z-index:60;
    margin-bottom: 20px;
  }

  .btn-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 14px;
    border: 1px solid var(--borda);
    border-radius: 8px;
    background: var(--card);
    color: var(--ink);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 14px;
    font-weight: 500;
  }

  .btn-toolbar:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .btn-toolbar svg {
    width: 18px;
    height: 18px;
  }

  /* LAYOUT PRINCIPAL */
  .rotinas-container {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 20px;
    margin-top: 20px;
  }

  .dias-sidebar {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    height: fit-content;
    position: sticky;
    top: 90px;
  }

  .periodo-secao {
    margin-bottom: 24px;
  }

  .periodo-secao h3 {
    font-size: 14px;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--borda);
  }

  .dia-item {
    padding: 12px 14px;
    border-radius: 10px;
    cursor: pointer;
    margin-bottom: 8px;
    transition: all 0.2s ease;
    font-weight: 600;
    font-size: 14px;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: 10px;
    border: 1px solid transparent;
  }

  .dia-item:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .dia-item.ativo {
    background: var(--azul);
    color: white;
  }

  .dia-item svg {
    width: 18px;
    height: 18px;
  }

  .dia-item.hoje {
    background: #fff7f0;
    border-color: #fed7aa;
    color: #f59e0b;
  }

  .dia-item.feriado {
    background: #fff7f0;
    border-color: #fed7aa;
    color: #e67e22;
  }

  .dia-item.sem-expediente {
    background: #f8f9fa;
    color: var(--muted);
  }

  .conteudo-area {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    min-height: 400px;
    position: relative;
  }

  .conteudo-header {
    border-bottom: 1px solid var(--borda);
    padding-bottom: 16px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .conteudo-header h2 {
    margin: 0;
    font-size: 18px;
    color: var(--ink-strong);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .conteudo-header h2 svg {
    width: 20px;
    height: 20px;
  }

  .conteudo-header-acoes {
    display: flex;
    gap: 8px;
  }

  .btn-acao {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid var(--borda);
    background: var(--card);
    color: var(--ink);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 12px;
    font-weight: 500;
  }

  .btn-acao:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .btn-imprimir {
    background: #f0f9ff !important;
    border-color: #bae6fd !important;
    color: var(--azul) !important;
  }

  .btn-imprimir:hover {
    background: #e0f2fe !important;
  }

  /* LEGENDA */
  .legenda-container {
    background: var(--card);
    border: 1px solid var(--borda);
    border-radius: 14px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(11,78,167,.06);
    margin-bottom: 20px;
  }

  .legenda-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
    cursor: pointer;
    padding: 12px 16px;
    border-radius: 10px;
    background: #f8f9fa;
    border: 1px solid var(--borda);
    transition: all 0.2s ease;
  }

  .legenda-header:hover {
    background: #f3f8ff;
    border-color: var(--borda-ativa);
  }

  .legenda-header h3 {
    margin: 0;
    font-size: 16px;
    color: var(--ink-strong);
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .legenda-header h3 svg {
    width: 18px;
    height: 18px;
    transition: transform 0.3s ease;
  }

  .legenda-header.ativo h3 svg {
    transform: rotate(180deg);
  }

  .legenda-conteudo {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .legenda-conteudo.ativo {
    max-height: 500px;
    overflow-y: auto;
  }

  .legenda-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 16px;
    padding: 16px 0;
  }

  .legenda-item {
    padding: 16px;
    border-radius: 10px;
    background: #f8f9fa;
    border: 1px solid var(--borda);
    transition: all 0.2s ease;
  }

  .legenda-item:hover {
    background: white;
    border-color: var(--borda-ativa);
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  .legenda-item-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .legenda-icone-grande {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .legenda-icone-grande svg {
    width: 18px;
    height: 18px;
    color: white;
  }

  .legenda-titulo {
    font-weight: 600;
    color: var(--ink-strong);
    font-size: 15px;
  }

  .legenda-desc {
    font-size: 13px;
    color: var(--muted);
    line-height: 1.5;
  }

  .legenda-detalhes {
    margin-top: 12px;
    padding: 12px;
    background: white;
    border-radius: 8px;
    border-left: 4px solid var(--borda);
    font-size: 13px;
    color: var(--ink);
    line-height: 1.5;
  }

  /* TAREFAS DO DIA */
  .tarefas-dia {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 16px;
  }

  .tarefa-card {
    background: var(--fundo);
    border: 1px solid var(--borda);
    border-radius: 12px;
    padding: 18px;
    transition: all 0.2s ease;
    border-left: 4px solid var(--azul);
  }

  .tarefa-card:hover {
    border-color: var(--borda-ativa);
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    transform: translateY(-2px);
  }

  .tarefa-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
  }

  .tarefa-titulo {
    font-weight: 600;
    color: var(--ink-strong);
    font-size: 15px;
    line-height: 1.4;
    flex: 1;
  }

  .tarefa-icone {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid transparent;
    flex-shrink: 0;
    margin-left: 12px;
  }

  .tarefa-icone:hover {
    transform: scale(1.1);
    border-color: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .tarefa-icone svg {
    width: 16px;
    height: 16px;
    color: white;
  }

  .tarefa-desc {
    font-size: 14px;
    color: var(--ink);
    line-height: 1.5;
    margin-bottom: 12px;
  }

  .tarefa-pessoa {
    display: inline-block;
    background: #e3f2fd;
    color: var(--azul);
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    margin-top: 8px;
  }

  .sem-tarefas {
    text-align: center;
    padding: 60px 20px;
    color: var(--muted);
    grid-column: 1 / -1;
  }

  .sem-tarefas svg {
    width: 64px;
    height: 64px;
    opacity: 0.5;
    margin-bottom: 16px;
  }

  /* CATEGORIAS */
  .categoria-N1 { border-left-color: var(--danger); }
  .categoria-N2 { border-left-color: var(--azul); }
  .categoria-N3 { border-left-color: var(--cinza-escuro); }
  .categoria-N4 { border-left-color: var(--success); }
  .categoria-N5 { border-left-color: var(--laranja); }
  .categoria-N6 { border-left-color: var(--roxo); }
  .categoria-N7 { border-left-color: #5d4037; }
  .categoria-N8 { border-left-color: var(--teal); }
  .categoria-N9 { border-left-color: #f4511e; }
  .categoria-N10 { border-left-color: #00acc1; }

  .categoria-N1 .tarefa-icone { background: var(--danger); }
  .categoria-N2 .tarefa-icone { background: var(--azul); }
  .categoria-N3 .tarefa-icone { background: var(--cinza-escuro); }
  .categoria-N4 .tarefa-icone { background: var(--success); }
  .categoria-N5 .tarefa-icone { background: var(--laranja); }
  .categoria-N6 .tarefa-icone { background: var(--roxo); }
  .categoria-N7 .tarefa-icone { background: #5d4037; }
  .categoria-N8 .tarefa-icone { background: var(--teal); }
  .categoria-N9 .tarefa-icone { background: #f4511e; }
  .categoria-N10 .tarefa-icone { background: #00acc1; }

  .legenda-N1 .legenda-icone-grande { background: var(--danger); }
  .legenda-N2 .legenda-icone-grande { background: var(--azul); }
  .legenda-N3 .legenda-icone-grande { background: var(--cinza-escuro); }
  .legenda-N4 .legenda-icone-grande { background: var(--success); }
  .legenda-N5 .legenda-icone-grande { background: var(--laranja); }
  .legenda-N6 .legenda-icone-grande { background: var(--roxo); }
  .legenda-N7 .legenda-icone-grande { background: #5d4037; }
  .legenda-N8 .legenda-icone-grande { background: var(--teal); }
  .legenda-N9 .legenda-icone-grande { background: #f4511e; }
  .legenda-N10 .legenda-icone-grande { background: #00acc1; }

  /* INFO BOXES */
  .info-box {
    background: #f0f7ff;
    padding: 16px;
    border-radius: 10px;
    border-left: 4px solid var(--azul);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .info-box svg {
    width: 24px;
    height: 24px;
    color: var(--azul);
    flex-shrink: 0;
  }

  .info-box p {
    margin: 0;
    color: var(--ink);
    font-size: 14px;
    line-height: 1.5;
  }

  .feriado-box {
    background: #fff7f0;
    border-left-color: var(--warn);
  }

  .feriado-box svg {
    color: var(--warn);
  }

  /* SEARCH */
  .search {
    position: relative;
    flex: 1 1 200px;
  }

  .search input {
    width: 100%;
    padding: 12px 40px 12px 40px;
    border: 1px solid var(--borda);
    border-radius: 12px;
    background: #fbfdff;
    color: var(--ink);
    font-size: 14px;
  }

  .search svg {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 18px;
    height: 18px;
  }

  /* ANIMAÇÕES */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .fade-in {
    animation: fadeIn 0.3s ease;
  }

  /* RESPONSIVO */
  @media (max-width: 768px) {
    .rotinas-container {
      grid-template-columns: 1fr;
    }
    .dias-sidebar {
      position: static;
      margin-bottom: 20px;
    }
    .tarefas-dia {
      grid-template-columns: 1fr;
    }
    .legenda-grid {
      grid-template-columns: 1fr;
    }
  }

  /* SCROLL TO TOP */
  .btn-voltar-topo {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: var(--azul);
    color: white;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0,123,255,0.3);
    transition: all 0.2s ease;
    z-index: 50;
    opacity: 0;
    visibility: hidden;
  }

  .btn-voltar-topo.visivel {
    opacity: 1;
    visibility: visible;
  }

  .btn-voltar-topo:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(0,123,255,0.4);
  }

  .btn-voltar-topo svg {
    width: 20px;
    height: 20px;
  }

  /* MODAL DE IMPRESSÃO */
  .modal-impressao {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.7);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal-impressao.aberto {
    display: flex;
  }

  .modal-conteudo {
    background: white;
    width: 95%;
    max-width: 1400px;
    max-height: 90vh;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
  }

  .modal-cabecalho {
    padding: 20px;
    border-bottom: 1px solid #eee;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .modal-cabecalho h3 {
    margin: 0;
    color: var(--ink-strong);
    font-size: 20px;
  }

  .modal-corpo {
    padding: 20px;
    overflow-y: auto;
    flex: 1;
  }

  .modal-rodape {
    padding: 20px;
    border-top: 1px solid #eee;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }

  .fechar-modal {
    background: #f8f9fa;
    border: 1px solid #ddd;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
  }

  .fechar-modal:hover {
    background: #e9ecef;
  }

  /* TABELA DE IMPRESSÃO - ESTILO DO SITE */
  .tabela-impressao-site {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 30px;
    font-size: 14px;
  }

  .tabela-impressao-site th {
    background-color: #4a6491;
    color: white;
    padding: 12px 15px;
    text-align: center;
    font-weight: 600;
    border: 1px solid #3a5379;
    vertical-align: top;
  }

  .tabela-impressao-site td {
    padding: 10px 12px;
    border: 1px solid #dee2e6;
    vertical-align: top;
    background-color: white;
  }

  .tabela-impressao-site .semana-header {
    background-color: #2c3e50;
    color: white;
    text-align: center;
    font-size: 16px;
    padding: 15px;
  }

  .tabela-impressao-site .dia-header {
    background-color: #4a6491;
    color: white;
    text-align: center;
    font-weight: bold;
    padding: 10px;
    font-size: 14px;
  }

  .tabela-impressao-site .dia-header.feriado {
    background-color: #e53935 !important;
  }

  .tabela-impressao-site .dia-header.sem-expediente {
    background-color: #78909c !important;
  }

  .tarefa-impressao {
    margin-bottom: 8px;
    padding: 8px;
    border-left: 3px solid #4a6491;
    background-color: #f8f9fa;
    border-radius: 4px;
    font-size: 13px;
  }

  .tarefa-impressao:last-child {
    margin-bottom: 0;
  }

  .tarefa-titulo-impressao {
    font-weight: 600;
    margin-bottom: 4px;
    color: #333;
  }

  .tarefa-pessoa-impressao {
    display: inline-block;
    background-color: #e3f2fd;
    color: #1565c0;
    padding: 2px 6px;
    border-radius: 10px;
    font-size: 11px;
    margin-top: 4px;
  }

  .sem-tarefas-impressao {
    color: #888;
    font-style: italic;
    text-align: center;
    padding: 20px;
    font-size: 13px;
  }

  .categoria-badge {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    color: white;
    margin-right: 5px;
  }

  /* LEGENDA IMPRESSÃO */
  .legenda-impressao {
    margin-top: 30px;
    padding: 15px;
    background-color: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #dee2e6;
  }

  .legenda-impressao h4 {
    margin: 0 0 15px 0;
    color: #2c3e50;
    text-align: center;
  }

  .legenda-grid-impressao {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
  }

  .legenda-item-impressao {
    display: flex;
    align-items: center;
    padding: 8px;
    background: white;
    border-radius: 6px;
    border-left: 4px solid #4a6491;
  }

  .legenda-cor-impressao {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    margin-right: 10px;
    flex-shrink: 0;
  }

  .legenda-texto-impressao {
    font-size: 12px;
  }

  .legenda-texto-impressao strong {
    display: block;
    margin-bottom: 2px;
  }

  /* IMPRESSÃO DIRETA */
  @media print {
    body * {
      visibility: hidden;
    }
    
    .modal-conteudo, .modal-conteudo * {
      visibility: visible;
    }
    
    .modal-conteudo {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      max-width: none;
      max-height: none;
      box-shadow: none;
      border: none;
      padding: 0;
      margin: 0;
      background: white;
    }
    
    .modal-cabecalho, .modal-rodape {
      display: none;
    }
    
    .tabela-impressao-site {
      page-break-inside: avoid;
    }
    
    .tarefa-impressao {
      page-break-inside: avoid;
    }
    
    @page {
      margin: 0.5cm;
      size: landscape;
    }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Rotinas Diárias</h1>
    <p class="lead">Sistema organizado de rotinas por dia da semana - Dezembro 2025 a Janeiro 2026</p>
  </header>

  <div class="toolbar">
    <div class="search">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
      </svg>
      <input type="search" id="campo-busca" placeholder="Buscar nas rotinas..." />
      <div class="resultados-busca" id="resultados-busca"></div>
    </div>
    <button class="btn-toolbar" id="btn-imprimir-tudo">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
        <rect x="6" y="14" width="12" height="8"/>
      </svg>
      Imprimir Tudo
    </button>
  </div>

  <div class="legenda-container">
    <div class="legenda-header" id="legenda-toggle">
      <h3>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/>
        </svg>
        Legenda das Categorias
      </h3>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
        <polyline points="6 9 12 15 18 9"/>
      </svg>
    </div>
    
    <div class="legenda-conteudo" id="legenda-conteudo">
      <div class="legenda-grid" id="legenda-grid">
        <!-- A legenda será carregada aqui -->
      </div>
    </div>
  </div>

  <div class="rotinas-container">
    <div class="dias-sidebar">
      <div class="periodo-secao">
        <h3>31/12/2025 - 02/01/2026</h3>
        <div class="dia-item" data-data="31/12/2025">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          31/12 - Quarta-feira
        </div>
        <div class="dia-item feriado" data-data="01/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
          01/01 - Quinta-feira
        </div>
        <div class="dia-item sem-expediente" data-data="02/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
          </svg>
          02/01 - Sexta-feira
        </div>
      </div>

      <div class="periodo-secao">
        <h3>05/01/2026 - 09/01/2026</h3>
        <div class="dia-item" data-data="05/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          05/01 - Segunda-feira
        </div>
        <div class="dia-item" data-data="06/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          06/01 - Terça-feira
        </div>
        <div class="dia-item" data-data="07/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          07/01 - Quarta-feira
        </div>
        <div class="dia-item" data-data="08/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          08/01 - Quinta-feira
        </div>
        <div class="dia-item" data-data="09/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          09/01 - Sexta-feira
        </div>
      </div>

      <div class="periodo-secao">
        <h3>12/01/2026 - 16/01/2026</h3>
        <div class="dia-item" data-data="12/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          12/01 - Segunda-feira
        </div>
        <div class="dia-item" data-data="13/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          13/01 - Terça-feira
        </div>
        <div class="dia-item" data-data="14/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          14/01 - Quarta-feira
        </div>
        <div class="dia-item" data-data="15/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          15/01 - Quinta-feira
        </div>
        <div class="dia-item" data-data="16/01/2026">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          16/01 - Sexta-feira
        </div>
      </div>
    </div>

    <div class="conteudo-area">
      <div class="conteudo-header">
        <h2 id="dia-titulo">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
          </svg>
          Selecione um dia
        </h2>
        <div class="conteudo-header-acoes">
          <button class="btn-acao btn-imprimir" id="btn-imprimir-dia">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
              <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
              <rect x="6" y="14" width="12" height="8"/>
            </svg>
            Imprimir Dia
          </button>
        </div>
      </div>

      <div id="conteudo-dinamico">
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Selecione um dia na barra lateral para visualizar as rotinas</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para impressão -->
<div class="modal-impressao" id="modal-impressao">
  <div class="modal-conteudo">
    <div class="modal-cabecalho">
      <h3 id="modal-titulo">Impressão de Rotinas</h3>
      <button class="fechar-modal" id="fechar-modal">&times;</button>
    </div>
    <div class="modal-corpo" id="modal-corpo">
      <!-- A tabela de impressão será carregada aqui -->
    </div>
    <div class="modal-rodape">
      <button class="btn-acao" id="btn-imprimir-modal">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
          <polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
          <rect x="6" y="14" width="12" height="8"/>
        </svg>
        Imprimir
      </button>
      <button class="fechar-modal">Cancelar</button>
    </div>
  </div>
</div>

<button class="btn-voltar-topo" id="btn-voltar-topo">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <polyline points="18 15 12 9 6 15"/>
  </svg>
</button>

<script>
// Dados das categorias (N1, N2, etc.)
const categorias = {
  "N1": {
    nome: "Cobranças WhatsApp",
    descricao: "Fazer cobranças no WhatsApp dos clientes",
    detalhes: "Para fazer as cobranças, tire o relatório de cobranças (ver site anotações) e no WhatsApp, procure pelo cliente e mande a mensagem pronta de cobranças dos boletos. Caso tenha algum cliente que está devendo boleto a um tempo e que não foi a protesto ainda, cobrar comprovante também.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"/></svg>`,
    cor: "#ef4444"
  },
  "N2": {
    nome: "Pedidos Clientes",
    descricao: "Mandar mensagem para clientes pedindo pedido",
    detalhes: "Na web do sistema, vá em telemarketing, olhe os clientes que ainda não tiveram pedidos gerados e peça pedindo para mandarem os pedidos. Horário: 9:00-9:30.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>`,
    cor: "#007BFF"
  },
  "N3": {
    nome: "Pedir Café",
    descricao: "Pedir café para produção caso precise",
    detalhes: "Confirmar na produção, geralmente na embalagem ou no setor do Ceará se precisa de café caso fiquem até mais tarde.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>`,
    cor: "#5d4037"
  },
  "N4": {
    nome: "Montagem Rotas",
    descricao: "Montagem das rotas de entrega",
    detalhes: "Confira a seção de montagem rotas nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>`,
    cor: "#10b981"
  },
  "N5": {
    nome: "Lista Embalagem",
    descricao: "Pegar lista da embalagem São José e Pão Total",
    detalhes: "Pegar ou pedir para trazerem a lista no escritório. Caso eles tenham perdido ou esquecido de levar, perguntar ao Guilherme ou ao Kauan o que faltou para deixar anotado.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
    cor: "#fb8c00"
  },
  "N6": {
    nome: "Fechamento Caixas",
    descricao: "Fechamento de caixas (Barão)",
    detalhes: "Confira a seção de fechamento caixas nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M16 10v4"/><path d="M8 10v4"/><path d="M12 10v4"/><path d="M2 10h20"/></svg>`,
    cor: "#8a2be2"
  },
  "N7": {
    nome: "Café Sábado",
    descricao: "Pedir café para sábado caso precise",
    detalhes: "Caso tenha produção sábado, tem que pedir na padaria café para a quantidade de pessoas que virão e pedir para entregar na fábrica. Mas caso não der, tem que pedir para alguém buscar.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8h1a4 4 0 0 1 0 8h-1"/><path d="M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>`,
    cor: "#5d4037"
  },
  "N8": {
    nome: "Acerto Célio",
    descricao: "Acerto com o fornecedor Célio",
    detalhes: "Confira o tópico Célio (pagamentos e pix) na seção fornecedores nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>`,
    cor: "#00897b"
  },
  "N9": {
    nome: "Lista São José",
    descricao: "Fazer lista da São José e Pão Total",
    detalhes: "Confira o tópico São José na seção geral nas anotações do site para mais informações.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>`,
    cor: "#f4511e"
  },
  "N10": {
    nome: "Adiantamento Salarial",
    descricao: "Adiantamento salarial no banco",
    detalhes: "No banco vá em folha de pagamento, clique em cadastrar, coloque a data e selecione os funcionários. Escreva os valores e confirme. Depois no aplicativo do banco, vá na opção de 2 fatores e na web, procure o adiantamento que acabou de fazer e clique em processar. Escaneie o QR code, confirme no celular e depois na web coloque o código que aparece no celular. Confirmar e pronto.",
    icone: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="6" width="20" height="12" rx="2"/><path d="M16 10v4"/><path d="M8 10v4"/><path d="M12 10v4"/><path d="M2 10h20"/></svg>`,
    cor: "#00acc1"
  }
};

// Dados das rotinas por data - ATUALIZADO COM OS DADOS DA IMAGEM
const rotinas = {
  "31/12/2025": {
    data: "31/12/2025",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "01/01/2026": {
    data: "01/01/2026",
    diaSemana: "Quinta-feira",
    feriado: true,
    feriadoNome: "Ano Novo",
    semExpediente: true,
    tarefas: []
  },
  "02/01/2026": {
    data: "02/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: true,
    tarefas: []
  },
  "05/01/2026": {
    data: "05/01/2026",
    diaSemana: "Segunda-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Entregar a embalagem",
        pessoa: "Emillie"
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Fazer cheques do início do mês",
        categoria: null,
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Entregar planilhas de autocontrole",
        categoria: null,
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "06/01/2026": {
    data: "06/01/2026",
    diaSemana: "Terça-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "07/01/2026": {
    data: "07/01/2026",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: "Gleyce"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "08/01/2026": {
    data: "08/01/2026",
    diaSemana: "Quinta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Deixar junto com os romaneios",
        pessoa: "Emillie"
      }
    ]
  },
  "09/01/2026": {
    data: "09/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "Até 11:00 ou 12:00",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para sábado caso precise",
        categoria: "N7",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Separar dinheiro caso tenha produção sábado",
        categoria: null,
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Acerto Célio",
        categoria: "N8",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "12/01/2026": {
    data: "12/01/2026",
    diaSemana: "Segunda-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Entregar a embalagem",
        pessoa: "Emillie"
      },
      {
        titulo: "Fechamento de caixas",
        categoria: "N6",
        descricao: "",
        pessoa: "Barão"
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Baixa notinhas e relatórios",
        categoria: null,
        descricao: "",
        pessoa: "Emillie"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "13/01/2026": {
    data: "13/01/2026",
    diaSemana: "Terça-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Marina volta",
        categoria: null,
        descricao: "Retorno da funcionária Marina",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "14/01/2026": {
    data: "14/01/2026",
    diaSemana: "Quarta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  },
  "15/01/2026": {
    data: "15/01/2026",
    diaSemana: "Quinta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Adiantamento salarial no banco",
        categoria: "N10",
        descricao: "",
        pessoa: "Marina"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Fazer lista da São José e Pão Total",
        categoria: "N9",
        descricao: "Deixar junto com os romaneios",
        pessoa: "Emillie"
      }
    ]
  },
  "16/01/2026": {
    data: "16/01/2026",
    diaSemana: "Sexta-feira",
    feriado: false,
    semExpediente: false,
    tarefas: [
      {
        titulo: "Fazer cobranças no WhatsApp",
        categoria: "N1",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Mandar mensagem p/ clientes pedindo pedido",
        categoria: "N2",
        descricao: "Horário: 9:00-9:30",
        pessoa: ""
      },
      {
        titulo: "Pegar a lista da embalagem da São José e Pão Total e guardar",
        categoria: "N5",
        descricao: "Até 11:00 ou 12:00",
        pessoa: ""
      },
      {
        titulo: "Pedir café para produção caso precise",
        categoria: "N3",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Pedir café para sábado caso precise",
        categoria: "N7",
        descricao: "",
        pessoa: ""
      },
      {
        titulo: "Separar dinheiro caso tenha produção sábado",
        categoria: null,
        descricao: "",
        pessoa: "Marina ou Barão"
      },
      {
        titulo: "Acerto Célio",
        categoria: "N8",
        descricao: "",
        pessoa: "Marina ou Barão"
      },
      {
        titulo: "Montagem rotas",
        categoria: "N4",
        descricao: "",
        pessoa: ""
      }
    ]
  }
};

// Sistema principal
class SistemaRotinas {
  constructor() {
    this.diaAtual = null;
    this.termoBusca = "";
    this.buscaAtiva = false;
    this.legendaAberta = false;
    
    this.init();
  }
  
  init() {
    this.carregarLegenda();
    this.configurarEventos();
    this.verificarHoje();
  }
  
  carregarLegenda() {
    const grid = document.getElementById("legenda-grid");
    let html = "";
    
    Object.entries(categorias).forEach(([codigo, categoria]) => {
      html += `
        <div class="legenda-item legenda-${codigo}" id="legenda-${codigo}">
          <div class="legenda-item-header">
            <div class="legenda-icone-grande">
              ${categoria.icone}
            </div>
            <div>
              <div class="legenda-titulo">${codigo}: ${categoria.nome}</div>
              <div class="legenda-desc">${categoria.descricao}</div>
            </div>
          </div>
          <div class="legenda-detalhes">
            ${categoria.detalhes}
          </div>
        </div>
      `;
    });
    
    grid.innerHTML = html;
  }
  
  configurarEventos() {
    // Dias da sidebar
    document.querySelectorAll(".dia-item").forEach(item => {
      item.addEventListener("click", () => {
        const data = item.getAttribute("data-data");
        this.carregarDia(data);
      });
    });
    
    // Toggle legenda
    document.getElementById("legenda-toggle").addEventListener("click", () => {
      this.toggleLegenda();
    });
    
    // Busca
    document.getElementById("campo-busca").addEventListener("input", (e) => {
      this.realizarBuscaGlobal(e.target.value);
    });
    
    // Fechar resultados ao clicar fora
    document.addEventListener("click", (e) => {
      if (!e.target.closest(".search")) {
        const resultados = document.getElementById("resultados-busca");
        if (resultados) resultados.style.display = "none";
      }
    });
    
    // Botão imprimir dia
    document.getElementById("btn-imprimir-dia").addEventListener("click", () => {
      this.imprimirDia();
    });
    
    // Botão imprimir tudo
    document.getElementById("btn-imprimir-tudo").addEventListener("click", () => {
      this.imprimirTudo();
    });
    
    // Botão imprimir no modal
    document.getElementById("btn-imprimir-modal").addEventListener("click", () => {
      window.print();
    });
    
    // Fechar modal
    document.getElementById("fechar-modal").addEventListener("click", () => {
      this.fecharModal();
    });
    
    document.querySelectorAll(".fechar-modal").forEach(btn => {
      if (btn.id !== "fechar-modal") {
        btn.addEventListener("click", () => {
          this.fecharModal();
        });
      }
    });
    
    // Botão voltar ao topo
    const btnTopo = document.getElementById("btn-voltar-topo");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 300) {
        btnTopo.classList.add("visivel");
      } else {
        btnTopo.classList.remove("visivel");
      }
    });
    
    btnTopo.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });
  }
  
  carregarDia(data) {
    this.diaAtual = data;
    const dia = rotinas[data];
    
    if (!dia) return;
    
    // Atualizar seleção na sidebar
    document.querySelectorAll(".dia-item").forEach(item => {
      item.classList.remove("ativo");
    });
    
    document.querySelector(`.dia-item[data-data="${data}"]`).classList.add("ativo");
    
    // Atualizar título
    document.getElementById("dia-titulo").innerHTML = `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M8 2v4M16 2v4M2 10h20"/>
      </svg>
      ${dia.data} - ${dia.diaSemana}
      ${dia.feriado ? `<span style="color: var(--warn); font-size: 14px;"> (${dia.feriadoNome})</span>` : ""}
      ${dia.semExpediente && !dia.feriado ? `<span style="color: var(--muted); font-size: 14px;"> (Sem expediente)</span>` : ""}
    `;
    
    // Renderizar conteúdo
    this.renderizarDia(dia);
  }
  
  renderizarDia(dia) {
    const container = document.getElementById("conteudo-dinamico");
    
    if (dia.semExpediente) {
      container.innerHTML = `
        <div class="info-box feriado-box">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>${dia.feriado ? dia.feriadoNome : "Sem expediente"} - Nenhuma tarefa agendada para este dia.</p>
        </div>
      `;
      return;
    }
    
    if (!dia.tarefas || dia.tarefas.length === 0) {
      container.innerHTML = `
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Nenhuma tarefa agendada para este dia</p>
        </div>
      `;
      return;
    }
    
    // Filtrar tarefas se houver busca
    let tarefas = dia.tarefas;
    if (this.buscaAtiva && this.termoBusca) {
      const termo = this.termoBusca.toLowerCase();
      tarefas = dia.tarefas.filter(tarefa => 
        tarefa.titulo.toLowerCase().includes(termo) ||
        (tarefa.pessoa && tarefa.pessoa.toLowerCase().includes(termo)) ||
        (tarefa.categoria && categorias[tarefa.categoria].nome.toLowerCase().includes(termo)) ||
        (tarefa.categoria && categorias[tarefa.categoria].descricao.toLowerCase().includes(termo))
      );
    }
    
    if (tarefas.length === 0) {
      container.innerHTML = `
        <div class="sem-tarefas">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
          </svg>
          <p>Nenhuma tarefa encontrada com o termo "${this.termoBusca}"</p>
        </div>
      `;
      return;
    }
    
    // Renderizar tarefas
    let html = `<div class="tarefas-dia">`;
    
    tarefas.forEach((tarefa, index) => {
      const categoria = tarefa.categoria ? categorias[tarefa.categoria] : null;
      const classeCategoria = tarefa.categoria ? ` categoria-${tarefa.categoria}` : "";
      
      html += `
        <div class="tarefa-card fade-in${classeCategoria}" style="animation-delay: ${index * 0.05}s">
          <div class="tarefa-header">
            <div class="tarefa-titulo">${tarefa.titulo}</div>
            ${tarefa.categoria ? `
              <div class="tarefa-icone" data-categoria="${tarefa.categoria}" title="Clique para ver detalhes da categoria">
                ${categoria.icone}
              </div>
            ` : ""}
          </div>
          ${tarefa.descricao ? `<div class="tarefa-desc">${tarefa.descricao}</div>` : ""}
          ${tarefa.pessoa ? `<div class="tarefa-pessoa">${tarefa.pessoa}</div>` : ""}
        </div>
      `;
    });
    
    html += `</div>`;
    container.innerHTML = html;
    
    // Adicionar eventos aos ícones
    document.querySelectorAll(".tarefa-icone").forEach(icone => {
      icone.addEventListener("click", (e) => {
        e.stopPropagation();
        const categoria = icone.getAttribute("data-categoria");
        this.mostrarCategoria(categoria);
      });
    });
  }
  
  realizarBuscaGlobal(termo) {
    const resultadosContainer = document.getElementById("resultados-busca");
    
    if (!resultadosContainer) return;
    
    if (termo.trim().length === 0) {
      resultadosContainer.style.display = "none";
      resultadosContainer.innerHTML = "";
      return;
    }
    
    this.termoBusca = termo.toLowerCase();
    let resultadosHTML = "";
    
    // Buscar em todos os dias
    Object.entries(rotinas).forEach(([data, dia]) => {
      if (dia.semExpediente && !dia.feriado) return;
      
      const tarefasEncontradas = dia.tarefas.filter(tarefa => 
        tarefa.titulo.toLowerCase().includes(this.termoBusca) ||
        (tarefa.pessoa && tarefa.pessoa.toLowerCase().includes(this.termoBusca)) ||
        (tarefa.categoria && categorias[tarefa.categoria].nome.toLowerCase().includes(this.termoBusca)) ||
        (tarefa.categoria && categorias[tarefa.categoria].descricao.toLowerCase().includes(this.termoBusca))
      );
      
      if (tarefasEncontradas.length > 0) {
        resultadosHTML += `<div class="resultado-item" data-data="${data}">`;
        resultadosHTML += `<div class="resultado-data">${dia.data} - ${dia.diaSemana}</div>`;
        tarefasEncontradas.forEach(tarefa => {
          resultadosHTML += `<div class="resultado-tarefa">${tarefa.titulo}</div>`;
        });
        resultadosHTML += `</div>`;
      }
    });
    
    if (resultadosHTML) {
      resultadosContainer.innerHTML = resultadosHTML;
      resultadosContainer.style.display = "block";
      
      // Adicionar evento de clique para cada resultado
      document.querySelectorAll(".resultado-item").forEach(item => {
        item.addEventListener("click", () => {
          const data = item.getAttribute("data-data");
          this.carregarDia(data);
          resultadosContainer.style.display = "none";
          resultadosContainer.innerHTML = "";
          document.getElementById("campo-busca").value = "";
        });
      });
    } else {
      resultadosContainer.innerHTML = '<div class="resultado-item">Nenhum resultado encontrado.</div>';
      resultadosContainer.style.display = "block";
    }
  }
  
  mostrarCategoria(codigo) {
    // Abrir legenda se estiver fechada
    if (!this.legendaAberta) {
      this.toggleLegenda(true);
    }
    
    // Rolar até a legenda
    setTimeout(() => {
      document.getElementById("legenda-conteudo").scrollIntoView({ behavior: "smooth" });
      
      // Destacar item
      this.destacarLegendaItem(codigo);
    }, 100);
  }
  
  destacarLegendaItem(codigo) {
    // Remover destaque anterior
    document.querySelectorAll(".legenda-item").forEach(item => {
      item.style.background = "";
      item.style.borderColor = "";
      item.style.boxShadow = "";
    });
    
    // Destacar novo item
    const item = document.getElementById(`legenda-${codigo}`);
    if (item) {
      item.style.background = "#f0f7ff";
      item.style.borderColor = "var(--azul)";
      item.style.boxShadow = "0 4px 12px rgba(0,0,0,0.05)";
      
      // Remover destaque após 3 segundos
      setTimeout(() => {
        item.style.background = "";
        item.style.borderColor = "";
        item.style.boxShadow = "";
      }, 3000);
    }
  }
  
  toggleLegenda(forcarAbrir = false) {
    const conteudo = document.getElementById("legenda-conteudo");
    const toggle = document.getElementById("legenda-toggle");
    
    if (forcarAbrir && !this.legendaAberta) {
      conteudo.classList.add("ativo");
      toggle.classList.add("ativo");
      this.legendaAberta = true;
    } else {
      conteudo.classList.toggle("ativo");
      toggle.classList.toggle("ativo");
      this.legendaAberta = conteudo.classList.contains("ativo");
    }
  }
  
  verificarHoje() {
    const hoje = new Date();
    const hojeFormatado = hoje.toLocaleDateString('pt-BR', {
      day: '2-digit',
      month: '2-digit',
      year: 'numeric'
    });
    
    // Verificar se hoje está nos dados
    if (rotinas[hojeFormatado]) {
      setTimeout(() => {
        this.carregarDia(hojeFormatado);
        
        // Destacar item na sidebar
        const itemHoje = document.querySelector(`.dia-item[data-data="${hojeFormatado}"]`);
        if (itemHoje) {
          itemHoje.classList.add("hoje");
        }
      }, 500);
    }
  }
  
  // Gerar tabela para impressão de um dia específico
  gerarTabelaDia(dia) {
    const semanas = this.agruparPorSemanas();
    let html = `<h2>${dia.data} - ${dia.diaSemana}</h2>`;
    
    if (dia.semExpediente) {
      html += `<p><strong>${dia.feriado ? dia.feriadoNome : "Sem expediente"}</strong></p>`;
    } else if (dia.tarefas && dia.tarefas.length > 0) {
      html += `<table class="tabela-impressao-site">`;
      html += `<thead><tr><th colspan="2" class="dia-header">${dia.data} - ${dia.diaSemana}</th></tr></thead>`;
      html += `<tbody>`;
      
      dia.tarefas.forEach(tarefa => {
        const categoria = tarefa.categoria ? categorias[tarefa.categoria] : null;
        
        html += `<tr>`;
        html += `<td width="70%">`;
        html += `<div class="tarefa-impressao">`;
        html += `<div class="tarefa-titulo-impressao">${tarefa.titulo}</div>`;
        if (tarefa.descricao) {
          html += `<div style="font-size: 12px; color: #666; margin-top: 4px;">${tarefa.descricao}</div>`;
        }
        if (tarefa.pessoa) {
          html += `<div class="tarefa-pessoa-impressao">${tarefa.pessoa}</div>`;
        }
        html += `</div>`;
        html += `</td>`;
        html += `<td width="30%">`;
        if (categoria) {
          html += `<span class="categoria-badge" style="background-color: ${categoria.cor}">${tarefa.categoria}: ${categoria.nome}</span>`;
        }
        html += `</td>`;
        html += `</tr>`;
      });
      
      html += `</tbody></table>`;
    } else {
      html += `<div class="sem-tarefas-impressao">Nenhuma tarefa agendada para este dia.</div>`;
    }
    
    return html;
  }
  
  // Agrupar dias por semanas (como no site)
  agruparPorSemanas() {
    const semanas = [
      {
        titulo: "31/12/2025 - 02/01/2026",
        dias: ["31/12/2025", "01/01/2026", "02/01/2026"]
      },
      {
        titulo: "05/01/2026 - 09/01/2026",
        dias: ["05/01/2026", "06/01/2026", "07/01/2026", "08/01/2026", "09/01/2026"]
      },
      {
        titulo: "12/01/2026 - 16/01/2026",
        dias: ["12/01/2026", "13/01/2026", "14/01/2026", "15/01/2026", "16/01/2026"]
      }
    ];
    
    return semanas;
  }
  
  // Gerar tabela completa para impressão (estilo do site)
  gerarTabelaCompleta() {
    const semanas = this.agruparPorSemanas();
    let html = `<h2 style="text-align: center; margin-bottom: 30px;">Rotinas Completas - Dezembro 2025 a Janeiro 2026</h2>`;
    
    semanas.forEach((semana, indexSemana) => {
      html += `<h3 style="text-align: center; margin: 30px 0 20px 0; color: #2c3e50;">${semana.titulo}</h3>`;
      html += `<table class="tabela-impressao-site">`;
      
      // Cabeçalho com dias da semana
      html += `<thead><tr>`;
      semana.dias.forEach(data => {
        const dia = rotinas[data];
        if (dia) {
          let classeHeader = "dia-header";
          if (dia.feriado) classeHeader += " feriado";
          if (dia.semExpediente && !dia.feriado) classeHeader += " sem-expediente";
          
          html += `<th class="${classeHeader}">${dia.data}<br>${dia.diaSemana}</th>`;
        }
      });
      html += `</tr></thead>`;
      
      // Encontrar o número máximo de tarefas em qualquer dia desta semana
      let maxTarefas = 0;
      semana.dias.forEach(data => {
        const dia = rotinas[data];
        if (dia && dia.tarefas) {
          maxTarefas = Math.max(maxTarefas, dia.tarefas.length);
        }
      });
      
      // Corpo da tabela com tarefas
      html += `<tbody>`;
      for (let i = 0; i < maxTarefas; i++) {
        html += `<tr>`;
        
        semana.dias.forEach(data => {
          const dia = rotinas[data];
          html += `<td>`;
          
          if (dia) {
            if (dia.semExpediente) {
              if (i === 0) {
                html += `<div class="sem-tarefas-impressao">${dia.feriado ? dia.feriadoNome : "Sem expediente"}</div>`;
              }
            } else if (dia.tarefas && dia.tarefas[i]) {
              const tarefa = dia.tarefas[i];
              const categoria = tarefa.categoria ? categorias[tarefa.categoria] : null;
              
              html += `<div class="tarefa-impressao">`;
              html += `<div class="tarefa-titulo-impressao">${tarefa.titulo}</div>`;
              if (tarefa.descricao) {
                html += `<div style="font-size: 12px; color: #666; margin-top: 4px;">${tarefa.descricao}</div>`;
              }
              if (tarefa.pessoa) {
                html += `<div class="tarefa-pessoa-impressao">${tarefa.pessoa}</div>`;
              }
              if (categoria) {
                html += `<div style="margin-top: 4px;"><span class="categoria-badge" style="background-color: ${categoria.cor}">${tarefa.categoria}</span></div>`;
              }
              html += `</div>`;
            } else if (i === 0 && (!dia.tarefas || dia.tarefas.length === 0)) {
              html += `<div class="sem-tarefas-impressao">Nenhuma tarefa</div>`;
            }
          }
          
          html += `</td>`;
        });
        
        html += `</tr>`;
      }
      html += `</tbody></table>`;
    });
    
    // Adicionar legenda
    html += this.gerarLegendaImpressao();
    
    return html;
  }
  
  gerarLegendaImpressao() {
    let html = `<div class="legenda-impressao">`;
    html += `<h4>Legenda das Categorias</h4>`;
    html += `<div class="legenda-grid-impressao">`;
    
    Object.entries(categorias).forEach(([codigo, categoria]) => {
      html += `
        <div class="legenda-item-impressao">
          <div class="legenda-cor-impressao" style="background-color: ${categoria.cor}"></div>
          <div class="legenda-texto-impressao">
            <strong>${codigo}: ${categoria.nome}</strong>
            <span>${categoria.descricao}</span>
          </div>
        </div>
      `;
    });
    
    html += `</div></div>`;
    return html;
  }
  
  abrirModal(titulo, conteudo) {
    document.getElementById("modal-titulo").textContent = titulo;
    document.getElementById("modal-corpo").innerHTML = conteudo;
    document.getElementById("modal-impressao").classList.add("aberto");
    
    // Rolar para o topo do modal
    document.getElementById("modal-corpo").scrollTop = 0;
  }
  
  fecharModal() {
    document.getElementById("modal-impressao").classList.remove("aberto");
  }
  
  imprimirDia() {
    if (!this.diaAtual) {
      alert("Selecione um dia para imprimir.");
      return;
    }
    
    const dia = rotinas[this.diaAtual];
    const titulo = `Rotina - ${dia.data} - ${dia.diaSemana}`;
    const conteudo = this.gerarTabelaDia(dia);
    
    this.abrirModal(titulo, conteudo);
  }
  
  imprimirTudo() {
    const titulo = "Rotinas Completas - Dezembro 2025 a Janeiro 2026";
    const conteudo = this.gerarTabelaCompleta();
    
    this.abrirModal(titulo, conteudo);
  }
}

// Inicializar quando o DOM estiver pronto
document.addEventListener("DOMContentLoaded", () => {
  new SistemaRotinas();
});
</script>
</body>
</html>
